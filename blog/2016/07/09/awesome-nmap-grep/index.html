<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>awesome nmap grep &middot; </title>

  
  <link rel="stylesheet" href="https://leonjza.github.io/css/poole.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/poole-overrides.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/hyde-overrides.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/hyde-x.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/highlight/solarized_light.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://leonjza.github.io/touch-icon-144-precomposed.png">
  <link href="https://leonjza.github.io/favicon.png" rel="icon">

  
  
  
  

  <meta name="description" content="">
  <meta name="keywords" content="nmap,grep,awesome">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44457032-2', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body class="theme-base-0d">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
      <h1></h1>
      <p class="lead">#!/slash/note<br />
<em>A checkbox unchecker&rsquo;s notepad</em></p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="https://leonjza.github.io/">Blog</a></li>
      
      <li class="sidebar-nav-item"><a href="https://leonjza.github.io/post">Posts</a></li>
      
      <li class="sidebar-nav-item"><a href="https://leonjza.github.io/about/">About Me</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/leonjza"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      
      
      
      <a href="https://twitter.com/leonjza"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      
      </li>
    </ul>

    

    <p>Copyright &copy; 2018 <a href="https://leonjza.github.io/license/">License</a><br/>
       Powered by <a href="http://gohugo.io">Hugo</a> and <a href="https://github.com/zyro/hyde-x">Hyde-X</a></p>

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">awesome nmap grep</h1>
    <span class="post-date">Jul 9, 2016 &middot; 2 minute read &middot; <a href="https://leonjza.github.io/blog/2016/07/09/awesome-nmap-grep/#disqus_thread">Comments</a>
    
    <br/>
    <a class="label" href="https://leonjza.github.io/categories/how-to">how to</a><a class="label" href="https://leonjza.github.io/categories/notes">notes</a><a class="label" href="https://leonjza.github.io/categories/nmap">nmap</a>
    </span>
    <p>Nmap&rsquo;s greppable output is really handy. Saving greppable output from a scan means the output is delimited in a way that can be easily processed using tools such as <code>grep</code>, <code>sed</code>, <code>cut</code> and <code>awk</code>.</p>


<figure>
    
        <img src="https://leonjza.github.io/images/nmap-project-logo.png" />
    
    
</figure>


<p>This post shows a few examples of post scan processing of the greppable output produced with the <code>-oG</code> flag. A more up to date repository with examples and command explanations can be found in my <a href="https://github.com/leonjza/awesome-nmap-grep">awesome-nmap-grep</a> github repository.
</p>

<h2 id="keep-in-mind">keep in mind</h2>

<p>All of the below commands assume an environment variable <code>NMAP_FILE</code> is set. This is simply the location of the output from nmaps <code>-oG</code>.</p>

<h3 id="count-number-of-open-ports">Count Number of Open Ports</h3>

<h4 id="command">command</h4>

<pre><code class="language-bash">NMAP_FILE=output.grep

egrep -v &quot;^#|Status: Up&quot; $NMAP_FILE | cut -d' ' -f2 -f4- | \
sed -n -e 's/Ignored.*//p' | \
awk -F, '{split($0,a,&quot; &quot;); printf &quot;Host: %-20s Ports Open: %d\n&quot; , a[1], NF}' \
| sort -k 5 -g
</code></pre>

<h4 id="output">output</h4>

<pre><code class="language-bash">Host: 127.0.0.1            Ports Open: 16
</code></pre>

<h3 id="top-10-open-ports">Top 10 Open Ports</h3>

<h4 id="command-1">command</h4>

<pre><code class="language-bash">NMAP_FILE=output.grep

egrep -v &quot;^#|Status: Up&quot; $NMAP_FILE | cut -d' ' -f4- | \
sed -n -e 's/Ignored.*//p' | tr ',' '\n' | sed -e 's/^[ \t]*//' | \
sort -n | uniq -c | sort -k 1 -r | head -n 10
</code></pre>

<h4 id="output-1">output</h4>

<pre><code class="language-bash">1 9001/open/tcp//tor-orport?///
1 9000/open/tcp//cslistener?///
1 8080/open/tcp//http-proxy///
1 80/open/tcp//http//Caddy/
1 6379/open/tcp//redis//Redis key-value store/
1 631/open/tcp//ipp//CUPS 2.1/
1 6234/open/tcp/////
1 58377/filtered/tcp/////
1 53/open/tcp//domain//dnsmasq 2.76/
1 49153/open/tcp//mountd//1-3/
</code></pre>

<h3 id="hosts-and-open-ports">Hosts and Open Ports</h3>

<h4 id="command-2">command</h4>

<pre><code class="language-bash">NMAP_FILE=output.grep

egrep -v &quot;^#|Status: Up&quot; $NMAP_FILE | cut -d' ' -f2 -f4- | \
sed -n -e 's/Ignored.*//p'  | \
awk '{print &quot;Host: &quot; $1 &quot; Ports: &quot; NF-1; $1=&quot;&quot;; for(i=2; i&lt;=NF; i++) { a=a&quot; &quot;$i; }; split(a,s,&quot;,&quot;); for(e in s) { split(s[e],v,&quot;/&quot;); printf &quot;%-8s %s/%-7s %s\n&quot; , v[2], v[3], v[1], v[5]}; a=&quot;&quot; }'
</code></pre>

<h4 id="output-2">output</h4>

<pre><code class="language-bash">Host: 127.0.0.1 Ports: 16
open     tcp/22    ssh
open     tcp/53    domain
open     tcp/80    http
open     tcp/443   https
open     tcp/631   ipp
open     tcp/3306  mysql
open     tcp/4767  unknown
open     tcp/6379
open     tcp/8080  http-proxy
open     tcp/8081  blackice-icecap
open     tcp/9000  cslistener
open     tcp/9001  tor-orport
open     tcp/49152 unknown
open     tcp/49153 unknown
filtered tcp/54695
filtered tcp/58369
</code></pre>

<p>As mentioned in the beginning, more up to date examples are available in the <a href="https://github.com/leonjza/awesome-nmap-grep">awesome-nmap-grep</a> github repository.</p>
  </div>
  <div id="disqus_thread"></div>
</div>


<script type="text/javascript">
var disqus_shortname = "slashnote";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



<script type="text/javascript">
    var disqus_shortname = "slashnote";
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script src="https://leonjza.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

