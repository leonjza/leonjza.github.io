<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
  <script type="application/ld+json">
{
    "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/leonjza.github.io"
    },
    "articleSection" : "post",
    "name" : "awesome nmap grep",
    "headline" : "awesome nmap grep",
    "description" : "\u003cp\u003eNmap\u0026rsquo;s greppable output is really handy. Saving greppable output from a scan means the output is delimited in a way that can be easily processed using tools such as \u003ccode\u003egrep\u003c\/code\u003e, \u003ccode\u003esed\u003c\/code\u003e, \u003ccode\u003ecut\u003c\/code\u003e and \u003ccode\u003eawk\u003c\/code\u003e.\u003c\/p\u003e\n\u003cfigure\u003e\n    \u003cimg src=\u0022\/images\/nmap-project-logo.png\u0022\/\u003e \n\u003c\/figure\u003e\n\n\u003cp\u003eThis post shows a few examples of post scan processing of the greppable output produced with the \u003ccode\u003e-oG\u003c\/code\u003e flag. A more up to date repository with examples and command explanations can be found in my \u003ca href=\u0022https:\/\/github.com\/leonjza\/awesome-nmap-grep\u0022\u003eawesome-nmap-grep\u003c\/a\u003e github repository.\u003c\/p\u003e",
    "inLanguage" : "en-US",
    "author" : "Leon Jacobs",
    "creator" : "Leon Jacobs",
    "publisher": "Leon Jacobs",
    "accountablePerson" : "Leon Jacobs",
    "copyrightHolder" : "Leon Jacobs",
    "copyrightYear" : "2016",
    "datePublished": "2016-07-09 15:55:48 \u002b0200 SAST",
    "dateModified" : "2016-07-09 15:55:48 \u002b0200 SAST",
    "url" : "https:\/\/leonjza.github.io\/blog\/2016\/07\/09\/awesome-nmap-grep\/",
    "wordCount" : "347",
    "keywords" : [ "how to","notes","nmap","Blog" ]
}
</script>


  <title>awesome nmap grep &middot; </title>

  
  <link rel="stylesheet" href="https://leonjza.github.io/css/poole.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/poole-overrides.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/hyde-overrides.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/hyde-x.css">
  <link rel="stylesheet" href="https://leonjza.github.io/css/highlight/solarized_light.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://leonjza.github.io/touch-icon-144-precomposed.png">
  <link href="https://leonjza.github.io/favicon.png" rel="icon">

  
  
  
  

  <meta name="description" content="">
  <meta name="keywords" content="nmap,grep,awesome">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44457032-2', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body class="theme-base-0d">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
      <h1></h1>
      <p class="lead">#!/slash/note<br>
<em>A checkbox unchecker&rsquo;s notepad</em></p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="https://leonjza.github.io/">Blog</a></li>
      
      <li class="sidebar-nav-item"><a href="https://leonjza.github.io/post">Posts</a></li>
      
      <li class="sidebar-nav-item"><a href="https://leonjza.github.io/about/">About Me</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/leonjza"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      
      
      
      <a href="https://twitter.com/leonjza"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      
      </li>
    </ul>

    

    <p>Copyright &copy; 2020 <a href="https://leonjza.github.io/license/">License</a><br/>
       Powered by <a href="http://gohugo.io">Hugo</a> and <a href="https://github.com/zyro/hyde-x">Hyde-X</a></p>

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">awesome nmap grep</h1>
    <span class="post-date">Jul 9, 2016 &middot; 2 minute read &middot; <a href="https://leonjza.github.io/blog/2016/07/09/awesome-nmap-grep/#disqus_thread">Comments</a>
    
    <br/>
    <a class="label" href="https://leonjza.github.io/categories/how-to">how to</a><a class="label" href="https://leonjza.github.io/categories/notes">notes</a><a class="label" href="https://leonjza.github.io/categories/nmap">nmap</a>
    </span>
    <p>Nmap&rsquo;s greppable output is really handy. Saving greppable output from a scan means the output is delimited in a way that can be easily processed using tools such as <code>grep</code>, <code>sed</code>, <code>cut</code> and <code>awk</code>.</p>
<figure>
    <img src="https://leonjza.github.io/images/nmap-project-logo.png"/> 
</figure>

<p>This post shows a few examples of post scan processing of the greppable output produced with the <code>-oG</code> flag. A more up to date repository with examples and command explanations can be found in my <a href="https://github.com/leonjza/awesome-nmap-grep">awesome-nmap-grep</a> github repository.</p>
<h2 id="keep-in-mind">keep in mind</h2>
<p>All of the below commands assume an environment variable <code>NMAP_FILE</code> is set. This is simply the location of the output from nmaps <code>-oG</code>.</p>
<h3 id="count-number-of-open-ports">Count Number of Open Ports</h3>
<h4 id="command">command</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NMAP_FILE<span style="color:#f92672">=</span>output.grep

egrep -v <span style="color:#e6db74">&#34;^#|Status: Up&#34;</span> $NMAP_FILE | cut -d<span style="color:#e6db74">&#39; &#39;</span> -f2 -f4- | <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>sed -n -e <span style="color:#e6db74">&#39;s/Ignored.*//p&#39;</span> | <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>awk -F, <span style="color:#e6db74">&#39;{split($0,a,&#34; &#34;); printf &#34;Host: %-20s Ports Open: %d\n&#34; , a[1], NF}&#39;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>| sort -k <span style="color:#ae81ff">5</span> -g
</code></pre></div><h4 id="output">output</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Host: 127.0.0.1            Ports Open: <span style="color:#ae81ff">16</span>
</code></pre></div><h3 id="top-10-open-ports">Top 10 Open Ports</h3>
<h4 id="command-1">command</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NMAP_FILE<span style="color:#f92672">=</span>output.grep

egrep -v <span style="color:#e6db74">&#34;^#|Status: Up&#34;</span> $NMAP_FILE | cut -d<span style="color:#e6db74">&#39; &#39;</span> -f4- | <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>sed -n -e <span style="color:#e6db74">&#39;s/Ignored.*//p&#39;</span> | tr <span style="color:#e6db74">&#39;,&#39;</span> <span style="color:#e6db74">&#39;\n&#39;</span> | sed -e <span style="color:#e6db74">&#39;s/^[ \t]*//&#39;</span> | <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>sort -n | uniq -c | sort -k <span style="color:#ae81ff">1</span> -r | head -n <span style="color:#ae81ff">10</span>
</code></pre></div><h4 id="output-1">output</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">1</span> 9001/open/tcp//tor-orport?///
<span style="color:#ae81ff">1</span> 9000/open/tcp//cslistener?///
<span style="color:#ae81ff">1</span> 8080/open/tcp//http-proxy///
<span style="color:#ae81ff">1</span> 80/open/tcp//http//Caddy/
<span style="color:#ae81ff">1</span> 6379/open/tcp//redis//Redis key-value store/
<span style="color:#ae81ff">1</span> 631/open/tcp//ipp//CUPS 2.1/
<span style="color:#ae81ff">1</span> 6234/open/tcp/////
<span style="color:#ae81ff">1</span> 58377/filtered/tcp/////
<span style="color:#ae81ff">1</span> 53/open/tcp//domain//dnsmasq 2.76/
<span style="color:#ae81ff">1</span> 49153/open/tcp//mountd//1-3/
</code></pre></div><h3 id="hosts-and-open-ports">Hosts and Open Ports</h3>
<h4 id="command-2">command</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NMAP_FILE<span style="color:#f92672">=</span>output.grep

egrep -v <span style="color:#e6db74">&#34;^#|Status: Up&#34;</span> $NMAP_FILE | cut -d<span style="color:#e6db74">&#39; &#39;</span> -f2 -f4- | <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>sed -n -e <span style="color:#e6db74">&#39;s/Ignored.*//p&#39;</span>  | <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>awk <span style="color:#e6db74">&#39;{print &#34;Host: &#34; $1 &#34; Ports: &#34; NF-1; $1=&#34;&#34;; for(i=2; i&lt;=NF; i++) { a=a&#34; &#34;$i; }; split(a,s,&#34;,&#34;); for(e in s) { split(s[e],v,&#34;/&#34;); printf &#34;%-8s %s/%-7s %s\n&#34; , v[2], v[3], v[1], v[5]}; a=&#34;&#34; }&#39;</span>
</code></pre></div><h4 id="output-2">output</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Host: 127.0.0.1 Ports: <span style="color:#ae81ff">16</span>
open     tcp/22    ssh
open     tcp/53    domain
open     tcp/80    http
open     tcp/443   https
open     tcp/631   ipp
open     tcp/3306  mysql
open     tcp/4767  unknown
open     tcp/6379
open     tcp/8080  http-proxy
open     tcp/8081  blackice-icecap
open     tcp/9000  cslistener
open     tcp/9001  tor-orport
open     tcp/49152 unknown
open     tcp/49153 unknown
filtered tcp/54695
filtered tcp/58369
</code></pre></div><p>As mentioned in the beginning, more up to date examples are available in the <a href="https://github.com/leonjza/awesome-nmap-grep">awesome-nmap-grep</a> github repository.</p>
  </div>
  <div id="disqus_thread"></div>
</div>


<script type="text/javascript">
var disqus_shortname = "slashnote";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



<script type="text/javascript">
    var disqus_shortname = "slashnote";
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script src="https://leonjza.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

