<!doctype html><html lang=en>
<head>
<title>
URL Expansion - I'm paranoid like that ::
#!/bin/note
— a checkbox uncheckers notepad
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="So there is a good use URL Shorteners, as they are most commonly known, are pretty useful in places where you are limited to the amount of characters you are allowed to type. Twitter being the prime example. However, it is not only because of services like that that these URL shortening services exist. Sometimes, URL&amp;rsquo;s are are just plain crazy long, and very error prone when you have to copy and paste/link them someone. I guess we can call this a useful feature?
">
<meta name=keywords content="blog,hack,ctf,leonjza,pentester,red team,attack">
<meta name=robots content="noodp">
<link rel=canonical href=https://leonjza.github.io/blog/2013/07/31/url-expansion-im-paranoid-like-that/>
<link rel=stylesheet href=https://leonjza.github.io/assets/style.css>
<link rel=stylesheet href=https://leonjza.github.io/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://leonjza.github.io/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://leonjza.github.io/img/favicon.png>
<link href=https://leonjza.github.io/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="URL Expansion - I'm paranoid like that">
<meta name=twitter:description content="So there is a good use
URL Shorteners, as they are most commonly known, are pretty useful in places where you are limited to the amount of characters you are allowed to type. Twitter being the prime example. However, it is not only because of services like that that these URL shortening services exist. Sometimes, URL&rsquo;s are are just plain crazy long, and very error prone when you have to copy and paste/link them someone. I guess we can call this a useful feature?">
<meta property="og:title" content="URL Expansion - I'm paranoid like that">
<meta property="og:description" content="So there is a good use
URL Shorteners, as they are most commonly known, are pretty useful in places where you are limited to the amount of characters you are allowed to type. Twitter being the prime example. However, it is not only because of services like that that these URL shortening services exist. Sometimes, URL&rsquo;s are are just plain crazy long, and very error prone when you have to copy and paste/link them someone. I guess we can call this a useful feature?">
<meta property="og:type" content="article">
<meta property="og:url" content="https://leonjza.github.io/blog/2013/07/31/url-expansion-im-paranoid-like-that/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2013-07-31T00:00:00+00:00">
<meta property="article:modified_time" content="2013-07-31T00:00:00+00:00"><meta property="og:site_name" content="#!/bin/note
">
</head>
<body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>#!/bin/note
</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about/>About Me</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about/>About Me</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>URL Expansion - I&rsquo;m paranoid like that</h1>
<div class=post-meta>
<span class=post-date>
2013-07-31
</span>
<span class=post-read-time>— 3 min read</span>
</div>
<div class=post-content>
<h2>Table of Contents</h2>
<aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href=#so-there-is-a-good-use>So there is a good use</a></li>
<li><a href=#and-a-bad-use>And a bad use</a></li>
<li><a href=#rise-of-the-url-expander>Rise of the URL Expander.</a></li>
<li><a href=#time-for-longurlpy>Time for longurl.py</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav></aside>
<h3 id=so-there-is-a-good-use>So there is a good use</h3>
<p>URL Shorteners, as they are most commonly known, are pretty useful in places where you are limited to the amount of characters you are allowed to type. Twitter being the prime example. However, it is not only because of services like that that these URL shortening services exist. Sometimes, URL&rsquo;s are are just plain crazy long, and very error prone when you have to copy and paste/link them someone. I guess we can call this a useful feature?</p>
<h3 id=and-a-bad-use>And a bad use</h3>
<p>Of course, like most of the stuff you find on the internet, there has to be a way to abuse it too. Many people that consider themselves to be &ldquo;IT Literate&rdquo;, be it second nature, or they have been burned before, will usually check out the link they are about to click. URL Shortening services take this &ldquo;check&rdquo; right out. It is now easier to get someone to click on a url to <em>somedodywebsite.io/free_trojan_screensaver_no_virus_promise.exe</em> as by the time the page has loaded, it may very well be too late.</p>
<p>There are also concerns about tracking too. But that is a different debate all together.</p>
<h3 id=rise-of-the-url-expander>Rise of the URL Expander.</h3>
<p>There are tons, and I mean, <strong>tons</strong> of &lsquo;URL Expansion&rsquo; services available online. <a href=http://longurl.org/,>http://longurl.org/,</a> <a href=http://urlex.org/>http://urlex.org/</a> and <a href=http://www.wheredoesthislinkgo.com/>http://www.wheredoesthislinkgo.com/</a> to name a few. All from a simple Google Search. There are even browser plugins that would automatically &lsquo;expand&rsquo; urls as you hover over them.</p>
<p>This is cool and all. But how do I know that those services are not modifying the URL&rsquo;s? How do I know the browser plugin is not also fooling around somehow? Does that sound pretty paranoid to you? Well&mldr; :D</p>
<h3 id=time-for-longurlpy>Time for longurl.py</h3>
<p>I wanted something to use on the command line, that would allow me to see <strong>exactly</strong> where I was going. Thus, <em>longurl.py</em> came to be.</p>
<p>Get the script with: <code>$ git clone https://github.com/leonjza/longurl.git</code></p>
<p>With this, I am able to see each 30x type redirect, as well as where it will take me. A sample usage case would be:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>% ./longurl.py http://t.co/CHwi0q7DyF
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Next stop: <span style=color:#e6db74>&#39;http://t.co/CHwi0q7DyF&#39;</span>
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Got status: <span style=color:#ae81ff>301</span> with reason: Moved Permanently
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Next stop: <span style=color:#e6db74>&#39;http://bit.ly/14hneHx&#39;</span>
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Got status: <span style=color:#ae81ff>301</span> with reason: Moved
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Next stop: <span style=color:#e6db74>&#39;http://t.co/lqyFnSivpw&#39;</span>
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Got status: <span style=color:#ae81ff>301</span> with reason: Moved Permanently
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Next stop: <span style=color:#e6db74>&#39;http://reg.cx/27nM&#39;</span>
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Got status: <span style=color:#ae81ff>302</span> with reason: Found
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Next stop: <span style=color:#e6db74>&#39;http://www.theregister.co.uk/2013/07/31/department_defence_no_lenovo_ban/&#39;</span>
<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Got status: <span style=color:#ae81ff>200</span> with reason: OK

<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> The final looks to be: <span style=color:#e6db74>&#39;http://www.theregister.co.uk/2013/07/31/department_defence_no_lenovo_ban/&#39;</span>
</code></pre></div><p>Now you can see each &lsquo;hop&rsquo; it would have taken, as well as have your &lsquo;check before click&rsquo; ability back. Like I said, there are lots of other ways to get the same thing done, but I preferred knowing exactly what is going on, rather than just getting the final URL, missing potential bad URL&rsquo;s in between that could lead to other <em>interesting</em> finding. :)</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://leonjza.github.io/blog/2013/08/03/kvm-redirecting-centos-kernel-and-tty-output-to-a-virtual-serial-console/>
<span class=button__icon>←</span>
<span class=button__text>KVM Redirecting CentOS Kernel and tty output to a virtual serial console</span>
</a>
</span>
<span class="button next">
<a href=https://leonjza.github.io/blog/2013/07/27/stuff-to-gource./>
<span class=button__text>'stuff' to Gource.</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user"><a href=https://twitter.com/leonjza>@leonjza</a></div>
</div>
</footer>
<script src=https://leonjza.github.io/assets/main.js></script>
<script src=https://leonjza.github.io/assets/prism.js></script>
</div>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-44457032-2','auto'),ga('send','pageview'))</script>
</body>
</html>