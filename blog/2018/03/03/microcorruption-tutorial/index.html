<!doctype html><html lang=en>
<head>
<title>
microcorruption - tutorial ::
#!/bin/note
— a checkbox uncheckers notepad
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content=" These posts will detail my answers to solving various microcorruption.com ctf challenges. To begin, you should have at least had a look at the lock manual for a number of helpful hints. These challenges are built to run on a MSP430 microcontroller unit, so if you need any assembly references, that is the architecture your are looking for!
Lets look at the tutorial level first.
">
<meta name=keywords content="blog,hack,ctf,leonjza,pentester,red team,attack">
<meta name=robots content="noodp">
<link rel=canonical href=https://leonjza.github.io/blog/2018/03/03/microcorruption-tutorial/>
<link rel=stylesheet href=https://leonjza.github.io/assets/style.css>
<link rel=stylesheet href=https://leonjza.github.io/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://leonjza.github.io/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://leonjza.github.io/img/favicon.png>
<link href=https://leonjza.github.io/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="microcorruption - tutorial">
<meta name=twitter:description content="
    
    
  


These posts will detail my answers to solving various microcorruption.com ctf challenges. To begin, you should have at least had a look at the lock manual for a number of helpful hints. These challenges are built to run on a MSP430 microcontroller unit, so if you need any assembly references, that is the architecture your are looking for!
Lets look at the tutorial level first.">
<meta property="og:title" content="microcorruption - tutorial">
<meta property="og:description" content="
    
    
  


These posts will detail my answers to solving various microcorruption.com ctf challenges. To begin, you should have at least had a look at the lock manual for a number of helpful hints. These challenges are built to run on a MSP430 microcontroller unit, so if you need any assembly references, that is the architecture your are looking for!
Lets look at the tutorial level first.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://leonjza.github.io/blog/2018/03/03/microcorruption-tutorial/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-03-03T21:28:12+02:00">
<meta property="article:modified_time" content="2018-03-03T21:28:12+02:00"><meta property="og:site_name" content="#!/bin/note
">
</head>
<body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>#!/bin/note
</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about/>About Me</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about/>About Me</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>microcorruption - tutorial</h1>
<div class=post-meta>
<span class=post-date>
2018-03-03
</span>
<span class=post-read-time>— 2 min read</span>
</div>
<div class=post-content>
<h2>Table of Contents</h2>
<aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#tutorial-level>tutorial level</a></li>
<li><a href=#solution>solution</a></li>
<li><a href=#other-challenges>other challenges</a></li>
</ul>
</li>
</ul>
</nav></aside>
<figure class=left>
<img src=/images/microcorruption/microcorruption.png>
</figure>
<p>These posts will detail my answers to solving various <a href=https://microcorruption.com>microcorruption.com</a> ctf challenges. To begin, you should have at least had a look at the <a href=https://microcorruption.com/manual.pdf>lock manual</a> for a number of helpful hints. These challenges are built to run on a MSP430 microcontroller unit, so if you need any assembly references, that is the architecture your are looking for!</p>
<p>Lets look at the tutorial level first.</p>
<h2 id=tutorial-level>tutorial level</h2>
<p>As expected, the first level is super simple. Most of your time is spent on this level getting to know the web based debugger as well as general tips and tricks for moving around.</p>
<p>When you follow the tutorial, you will notice that the flaw you need to exploit in this challenge is simply a length based one as the <code>check_password</code> routine simply checks if the password has a length of <code>9</code>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>4484</span> <span style=color:#960050;background-color:#1e0010>&lt;</span><span style=color:#a6e22e>check_password</span><span style=color:#960050;background-color:#1e0010>&gt;</span>
<span style=color:#960050;background-color:#1e0010>4484:</span>  <span style=color:#960050;background-color:#1e0010>6</span><span style=color:#a6e22e>e4f</span>           <span style=color:#66d9ef>mov.b</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#66d9ef>r15</span>, <span style=color:#66d9ef>r14</span>
<span style=color:#960050;background-color:#1e0010>4486:</span>  <span style=color:#960050;background-color:#1e0010>1</span><span style=color:#a6e22e>f53</span>           <span style=color:#66d9ef>inc</span>   <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>4488:</span>  <span style=color:#960050;background-color:#1e0010>1</span><span style=color:#a6e22e>c53</span>           <span style=color:#66d9ef>inc</span>   <span style=color:#66d9ef>r12</span>
<span style=color:#960050;background-color:#1e0010>448</span>a:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>e93</span>           <span style=color:#66d9ef>tst</span>   <span style=color:#66d9ef>r14</span>
<span style=color:#960050;background-color:#1e0010>448</span>c:  <span style=color:#a6e22e>fb23</span>           <span style=color:#66d9ef>jnz</span>   <span style=color:#75715e>#0x4484 &lt;check_password+0x0&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>448</span><span style=color:#66d9ef>e</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>c90</span> <span style=color:#ae81ff>0900</span>      <span style=color:#66d9ef>cmp</span>   <span style=color:#75715e>#0x9, r12   ; password length check
</span><span style=color:#75715e></span><span style=color:#ae81ff>4492</span>:  <span style=color:#ae81ff>0224</span>           <span style=color:#66d9ef>jeq</span>   <span style=color:#75715e>#0x4498 &lt;check_password+0x14&gt;
</span></code></pre></div><p>Once you hit the instruction at <code>0x4484</code>, the first character of the password you entered is loaded into <code>r14</code> (which you can see from the memory layout if you were to browse to <code>0x439c</code>) from the memory location pointed to in <code>r15</code>. Next, the registers <code>r12</code> and <code>r15</code> are incremented. This will continue until a null byte (a typical string terminator in C) is reached, causing the jump at <code>0x448c</code> not to be followed, making the <code>cmp</code> be the next instruction.</p>
<p>If <code>r12</code> ends up being <code>0x0009</code> (indicating that out passwords was 8 characters long with a null byte), then the jump at <code>0x4492</code> will occur, finally calling the interrupt to unlock the lock.</p>
<figure class=left>
<img src=/images/microcorruption/microcorruption_tutorial.png>
</figure>
<h2 id=solution>solution</h2>
<p>Enter any 8 character string, such as <code>password</code>.</p>
<h2 id=other-challenges>other challenges</h2>
<p>For my other write ups in the microcorruption series, checkout <a href=https://leonjza.github.io/categories/microcorruption/>this</a> link.</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://leonjza.github.io/blog/2018/03/03/microcorruption-new-orleans/>
<span class=button__icon>←</span>
<span class=button__text>microcorruption - new orleans</span>
</a>
</span>
<span class="button next">
<a href=https://leonjza.github.io/blog/2017/12/13/building-the-bsidescpt17-rf-challenge/>
<span class=button__text>building the bsidescpt17 rf challenge</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user"><a href=https://twitter.com/leonjza>@leonjza</a></div>
</div>
</footer>
<script src=https://leonjza.github.io/assets/main.js></script>
<script src=https://leonjza.github.io/assets/prism.js></script>
</div>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-44457032-2','auto'),ga('send','pageview'))</script>
</body>
</html>