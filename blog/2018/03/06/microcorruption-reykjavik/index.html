<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>microcorruption - reykjavik | #!/bin/note
</title>
<meta name=keywords content>
<meta name=description content="
     


This post is part of the series of solving microcorruption.com ctf challenges which continues from the previous challenge called Cusco. This challenge is titled Reykjavik.
This challenge has the following description towards the bottom:

This is Software Revision 02. This release contains military-grade encryption so users can be confident that the passwords they enter can not be read from memory. We apologize for making it too easy for the password to be recovered on prior versions. The engineers responsible have been sacked.

Rough. But ok, time to see of its better this time. Also, &ldquo;military-grade encryption&rdquo;, hah! :P">
<meta name=author content="Leon Jacobs">
<link rel=canonical href=https://leonjza.github.io/blog/2018/03/06/microcorruption-reykjavik/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.5e2b4101351c21e906f398ae96901791830f58d430f96f2659dab7eaef7b3cb7.css integrity="sha256-XitBATUcIekG85iulpAXkYMPWNQw+W8mWdq36u97PLc=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://leonjza.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://leonjza.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://leonjza.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://leonjza.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://leonjza.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.88.1">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-44457032-2','auto'),ga('send','pageview'))</script><meta property="og:title" content="microcorruption - reykjavik">
<meta property="og:description" content="
     


This post is part of the series of solving microcorruption.com ctf challenges which continues from the previous challenge called Cusco. This challenge is titled Reykjavik.
This challenge has the following description towards the bottom:

This is Software Revision 02. This release contains military-grade encryption so users can be confident that the passwords they enter can not be read from memory. We apologize for making it too easy for the password to be recovered on prior versions. The engineers responsible have been sacked.

Rough. But ok, time to see of its better this time. Also, &ldquo;military-grade encryption&rdquo;, hah! :P">
<meta property="og:type" content="article">
<meta property="og:url" content="https://leonjza.github.io/blog/2018/03/06/microcorruption-reykjavik/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-03-06T20:25:12+02:00">
<meta property="article:modified_time" content="2018-03-06T20:25:12+02:00"><meta property="og:site_name" content="#!/bin/note
">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="microcorruption - reykjavik">
<meta name=twitter:description content="
     


This post is part of the series of solving microcorruption.com ctf challenges which continues from the previous challenge called Cusco. This challenge is titled Reykjavik.
This challenge has the following description towards the bottom:

This is Software Revision 02. This release contains military-grade encryption so users can be confident that the passwords they enter can not be read from memory. We apologize for making it too easy for the password to be recovered on prior versions. The engineers responsible have been sacked.

Rough. But ok, time to see of its better this time. Also, &ldquo;military-grade encryption&rdquo;, hah! :P">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://leonjza.github.io/posts/"},{"@type":"ListItem","position":3,"name":"microcorruption - reykjavik","item":"https://leonjza.github.io/blog/2018/03/06/microcorruption-reykjavik/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"microcorruption - reykjavik","name":"microcorruption - reykjavik","description":"  This post is part of the series of solving microcorruption.com ctf challenges which continues from the previous challenge called Cusco. This challenge is titled Reykjavik.\nThis challenge has the following description towards the bottom:\n This is Software Revision 02. This release contains military-grade encryption so users can be confident that the passwords they enter can not be read from memory. We apologize for making it too easy for the password to be recovered on prior versions. The engineers responsible have been sacked.\n Rough. But ok, time to see of its better this time. Also, \u0026ldquo;military-grade encryption\u0026rdquo;, hah! :P\n","keywords":[],"articleBody":"  This post is part of the series of solving microcorruption.com ctf challenges which continues from the previous challenge called Cusco. This challenge is titled Reykjavik.\nThis challenge has the following description towards the bottom:\n This is Software Revision 02. This release contains military-grade encryption so users can be confident that the passwords they enter can not be read from memory. We apologize for making it too easy for the password to be recovered on prior versions. The engineers responsible have been sacked.\n Rough. But ok, time to see of its better this time. Also, “military-grade encryption”, hah! :P\nreykjavik The main routine this time is a quite a bit different when compared to the previous challenges:\n4438 main 4438: 3e40 2045 mov #0x4520, r14 443c: 0f4e mov r14, r15 443e: 3e40 f800 mov #0xf8, r14 4442: 3f40 0024 mov #0x2400, r15 4446: b012 8644 call #0x4486   ; once enc is done, call something without a label? 444a: b012 0024 call #0x2400 444e: 0f43 clr r15 Only two call’s are made in main, of which the second has no label.\nThe enc routine has quite a bit of logic though. Taking a closer, annotated look at the enc routine as I was performing a static analysis resulted in the following:\n4486 enc 4486: 0b12 push r11 4488: 0a12 push r10 448a: 0912 push r9 448c: 0812 push r8 ; clearing r13, might mean that the instruction at ; 4490 will move a 0x0 byte into 0x247c, indicating ; the start of a loop  448e: 0d43 clr r13 4490: cd4d 7c24 mov.b r13, 0x247c(r13) 4494: 1d53 inc r13 ; this looks like a loop that will continue until ; r13 is incremented up to 0x0100 (256). interestingly ; that is bytes 0x00 to 0xff...  4496: 3d90 0001 cmp #0x100, r13 449a: fa23 jne #0x4490   ; not sure what this is preparing for yet, but it looks ; like r11 is being setup for a loop here.  449c: 3c40 7c24 mov #0x247c, r12 44a0: 0d43 clr r13 44a2: 0b4d mov r13, r11 44a4: 684c mov.b @r12, r8 44a6: 4a48 mov.b r8, r10 44a8: 0d5a add r10, r13 44aa: 0a4b mov r11, r10 ; some arithmetic. maybe an indication of a decrypt of ; some sorts or a simple byte swap happening here, needs ; debugger  44ac: 3af0 0f00 and #0xf, r10 44b0: 5a4a 7244 mov.b 0x4472(r10), r10 44b4: 8a11 sxt r10 44b6: 0d5a add r10, r13 44b8: 3df0 ff00 and #0xff, r13 44bc: 0a4d mov r13, r10 44be: 3a50 7c24 add #0x247c, r10 44c2: 694a mov.b @r10, r9 44c4: ca48 0000 mov.b r8, 0x0(r10) 44c8: cc49 0000 mov.b r9, 0x0(r12) 44cc: 1b53 inc r11 44ce: 1c53 inc r12 ; the loop with r11 for another 256 bytes  44d0: 3b90 0001 cmp #0x100, r11 44d4: e723 jne #0x44a4   44d6: 0b43 clr r11 44d8: 0c4b mov r11, r12 44da: 183c jmp #0x450c  44dc: 1c53 inc r12 44de: 3cf0 ff00 and #0xff, r12 44e2: 0a4c mov r12, r10 44e4: 3a50 7c24 add #0x247c, r10 44e8: 684a mov.b @r10, r8 44ea: 4b58 add.b r8, r11 44ec: 4b4b mov.b r11, r11 44ee: 0d4b mov r11, r13 44f0: 3d50 7c24 add #0x247c, r13 44f4: 694d mov.b @r13, r9 44f6: cd48 0000 mov.b r8, 0x0(r13) 44fa: ca49 0000 mov.b r9, 0x0(r10) 44fe: 695d add.b @r13, r9 4500: 4d49 mov.b r9, r13 ; probably the actual decryption taking place here, as ; r15 (which was set in main) is used as an offset.  4502: dfed 7c24 0000 xor.b 0x247c(r13), 0x0(r15) 4508: 1f53 inc r15 ; decrement r14 until we get to 0, which will prevent the ; jmp back up from being taken, ending the routine.  ; r14 was set to to 0xf8 (248) in main, so that might mean ; that the decrypted bytes is 248 long.  450a: 3e53 add #-0x1, r14 450c: 0e93 tst r14 450e: e623 jnz #0x44dc  4510: 3841 pop r8 4512: 3941 pop r9 4514: 3a41 pop r10 4516: 3b41 pop r11 4518: 3041 ret As you can see, this is a busy routine. There is very clearly some form of byte write, swapping and xor occurring as expected. Some key points to note though is that the memory location 0x2400 that was written to r15 in main is used as a starting offset for an xor instruction occurring within enc. So, that is definitely an interesting location to watch as we debug this routine.\ndebugging To gain a better understanding of what is happening in enc, I set a breakpoint at the entry point of this routine with break 4486. Then continuing the CPU and manually stepping through the instructions while watching what happens around memory address 0x2400 revealed the following:\n  It looks like a payload already lives from 0x2400 and a range of bytes from 0x00 to 0xff is written from 0x247c onwards.\n  This memory state is achieved right after this loop has completed and the jump at 0x449a is not taken. Alright. Lets move on. The next loop also does a whole bunch of manipulations on the byte range that was just written to memory (and a few other things). There are some weird instructions like the mov.b r11,r11 at 0x44ec that I couldn’t quite understand, but nonetheless.\nThe most important thing to see in this loop is that the bytes at 0x2400 are XOR’d with those at 0x24f9 when the xor.b 0x247c(r13), 0x0(r15) instruction is called the first time. The second time, 0x247c(r13) calculates to 0x24b6, which is the next XOR.\n  This loop continues until r14 reaches zero, and the registers before the call to enc is restored and the function returns. At this stage, the memory contents at 0x2400 looks as follows (which should now be the decrypted contents):\n  At this stage its pretty clear that the call to jump to 0x2400 in main was because then the encrypted opcodes would be available there and further processing should take place. Now, reading the opcodes like that from a memory dump sucks. So, to make it a little more digestible, I slapped the dump into https://onlinedisassembler.com. The process was pretty simple; select the memory dump from microcorruption, paste it into a file, cleanup the dump with cat dump | cut -d\" \" -f2-11 and paste that result into the RAW section in the disassembler. Finally, set the architecture to MSP430 and profit!\n  After pasting that into the disassembler, I quickly realised that the whole payload might not be valid code for this section. After the ret the instructions became pretty crazy, so I just removed those. The final opcodes I used (which was ~256 bytes when counted with cat dump.raw | tr -d ' ' | wc -c) were:\n0b12 0412 0441 2452 3150 e0ff 3b40 2045 073c 1b53 8f11 0f12 0312 b012 6424 2152 6f4b 4f93 f623 3012 0a00 0312 b012 6424 2152 3012 1f00 3f40 dcff 0f54 0f12 2312 b012 6424 3150 0600 b490 db01 dcff 0520 3012 7f00 b012 6424 2153 3150 2000 3441 3b41 3041 1e41 0200 0212 0f4e 8f10 024f 32d0 0080 b012 1000 3241 3041 Anyways, I could now step through these instructions in the debugger, and have a disassembled reference I could refer to and see what is happening. The opcodes in the online disassembler would also correspond with those on microcorruption at the top right section which helped confirm that I was on the right track.\nStepping through each instruction, annotating what I thought was happening helped me understand what was going on. After a few rounds of running the routine, the following instructions were the most interesting as they were the instructions called just before it would jump away from the unlocking logic.\ncmp #0x1db, -0x24(r4) jnz $+0xc I needed to see what is happening at -0x24(r4) and see if I can control that value. To help me locate the memory location of the data used for the cmp, I had to do a little offset calculation. First, the cmp instruction was at 0x2448, found by simply looking at the program counter (pc) as I debugged the routine. A breakpoint here let me inspect the registers and perform the offset calculations needed to know what data was used in the cmp. Register r4 contained 0x43fe which is 17406, so taking 0x24 (36) from that ends you up with 0x43fe.\n 0x43fe 17406  0x43fe-36 17370  hex(0x43fe-36) '0x43da'   The data at 0x43da was the start of my password buffer, which is effectively what is being used in the cmp instruction. Making sure my password entered started with 0xdb01 (remember, little endian) would be enough for this compare to result in the status flag being set to not have the next conditional jump taken, resulting in a value of 0x7f being pushed to the stack and a syscall being made to unlock the lock!\nMy final, annotated version of the dissasembled opcodes looked as follows:\n  solution Enter db01 as hex encoded input.\nother challenges For my other write ups in the microcorruption series, checkout this link.\n","wordCount":"1497","inLanguage":"en","datePublished":"2018-03-06T20:25:12+02:00","dateModified":"2018-03-06T20:25:12+02:00","author":{"@type":"Person","name":"Leon Jacobs"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://leonjza.github.io/blog/2018/03/06/microcorruption-reykjavik/"},"publisher":{"@type":"Organization","name":"#!/bin/note\n","logo":{"@type":"ImageObject","url":"https://leonjza.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://leonjza.github.io accesskey=h title="#!/bin/note
 (Alt + H)">#!/bin/note
</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://leonjza.github.io/about/ title="About Me">
<span>About Me</span>
</a>
</li>
<li>
<a href=https://leonjza.github.io/archives title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://leonjza.github.io/categories title=Categories>
<span>Categories</span>
</a>
</li>
<li>
<a href=https://leonjza.github.io/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://leonjza.github.io>Home</a>&nbsp;»&nbsp;<a href=https://leonjza.github.io/posts/>Posts</a></div>
<h1 class=post-title>
microcorruption - reykjavik
</h1>
<div class=post-meta>March 6, 2018&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Leon Jacobs&nbsp;|&nbsp;<a href=https://github.com/leonjza/leonjza.github.io/tree/source/content/posts/2018-03-06-microcorruption---reykjavik.markdown rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#reykjavik aria-label=reykjavik>reykjavik</a><ul>
<li>
<a href=#debugging aria-label=debugging>debugging</a></li></ul>
</li>
<li>
<a href=#solution aria-label=solution>solution</a></li>
<li>
<a href=#other-challenges aria-label="other challenges">other challenges</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><figure>
<img loading=lazy src=/images/microcorruption/microcorruption.png>
</figure>
<p>This post is part of the series of solving <a href=https://microcorruption.com>microcorruption.com</a> ctf challenges which continues from the <a href=https://leonjza.github.io/blog/2018/03/06/microcorruption---cusco/>previous challenge</a> called <em>Cusco</em>. This challenge is titled <em>Reykjavik</em>.</p>
<p>This challenge has the following description towards the bottom:</p>
<blockquote>
<p>This is Software Revision 02. This release contains military-grade encryption so users can be confident that the passwords they enter can not be read from memory. We apologize for making it too easy for the password to be recovered on prior versions. The engineers responsible have been sacked.</p>
</blockquote>
<p>Rough. But ok, time to see of its better this time. Also, &ldquo;military-grade encryption&rdquo;, hah! :P</p>
<h2 id=reykjavik>reykjavik<a hidden class=anchor aria-hidden=true href=#reykjavik>#</a></h2>
<p>The <code>main</code> routine this time is a quite a bit different when compared to the previous challenges:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>4438</span> <span style=color:#960050;background-color:#1e0010>&lt;</span><span style=color:#a6e22e>main</span><span style=color:#960050;background-color:#1e0010>&gt;</span>
<span style=color:#960050;background-color:#1e0010>4438:</span>  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>e40</span> <span style=color:#ae81ff>2045</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x4520, r14
</span><span style=color:#75715e></span><span style=color:#ae81ff>443</span><span style=color:#66d9ef>c</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>f4e</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r14</span>, <span style=color:#66d9ef>r15</span>
<span style=color:#960050;background-color:#1e0010>443</span>e:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>e40</span> <span style=color:#66d9ef>f800</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0xf8, r14
</span><span style=color:#75715e></span><span style=color:#ae81ff>4442</span>:  <span style=color:#ae81ff>3</span><span style=color:#66d9ef>f40</span> <span style=color:#ae81ff>0024</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x2400, r15
</span><span style=color:#75715e></span><span style=color:#ae81ff>4446</span>:  <span style=color:#66d9ef>b012</span> <span style=color:#ae81ff>8644</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x4486 &lt;enc&gt;
</span><span style=color:#75715e></span>
<span style=color:#75715e>; once enc is done, call something without a label?
</span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>444</span>a:  <span style=color:#a6e22e>b012</span> <span style=color:#ae81ff>0024</span>      <span style=color:#66d9ef>call</span>  <span style=color:#75715e>#0x2400
</span><span style=color:#75715e></span><span style=color:#ae81ff>444</span><span style=color:#66d9ef>e</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>f43</span>           <span style=color:#66d9ef>clr</span>   <span style=color:#66d9ef>r15</span>
</code></pre></div><p>Only two <code>call</code>&rsquo;s are made in <code>main</code>, of which the second has no label.</p>
<p>The <code>enc</code> routine has quite a bit of logic though. Taking a closer, annotated look at the <code>enc</code> routine as I was performing a static analysis resulted in the following:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#960050;background-color:#1e0010>4486</span> <span style=color:#960050;background-color:#1e0010>&lt;</span><span style=color:#a6e22e>enc</span><span style=color:#960050;background-color:#1e0010>&gt;</span>
<span style=color:#960050;background-color:#1e0010>4486:</span>  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>b12</span>           <span style=color:#66d9ef>push</span>  <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>4488:</span>  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>a12</span>           <span style=color:#66d9ef>push</span>  <span style=color:#66d9ef>r10</span>
<span style=color:#960050;background-color:#1e0010>448</span>a:  <span style=color:#960050;background-color:#1e0010>0912</span>           <span style=color:#a6e22e>push</span>  <span style=color:#66d9ef>r9</span>
<span style=color:#960050;background-color:#1e0010>448</span>c:  <span style=color:#960050;background-color:#1e0010>0812</span>           <span style=color:#a6e22e>push</span>  <span style=color:#66d9ef>r8</span>

<span style=color:#75715e>; clearing r13, might mean that the instruction at
</span><span style=color:#75715e>; 4490 will move a 0x0 byte into 0x247c, indicating
</span><span style=color:#75715e>; the start of a loop
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>448</span>e:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>d43</span>           <span style=color:#66d9ef>clr</span>   <span style=color:#66d9ef>r13</span>
<span style=color:#960050;background-color:#1e0010>4490:</span>  <span style=color:#a6e22e>cd4d</span> <span style=color:#ae81ff>7</span><span style=color:#66d9ef>c24</span>      <span style=color:#66d9ef>mov.b</span> <span style=color:#66d9ef>r13</span>, <span style=color:#ae81ff>0x247c</span>(<span style=color:#66d9ef>r13</span>)
<span style=color:#960050;background-color:#1e0010>4494:</span>  <span style=color:#960050;background-color:#1e0010>1</span><span style=color:#a6e22e>d53</span>           <span style=color:#66d9ef>inc</span>   <span style=color:#66d9ef>r13</span>

<span style=color:#75715e>; this looks like a loop that will continue until
</span><span style=color:#75715e>; r13 is incremented up to 0x0100 (256). interestingly
</span><span style=color:#75715e>; that is bytes 0x00 to 0xff...
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>4496:</span>  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>d90</span> <span style=color:#ae81ff>0001</span>      <span style=color:#66d9ef>cmp</span>   <span style=color:#75715e>#0x100, r13
</span><span style=color:#75715e></span><span style=color:#ae81ff>449</span><span style=color:#66d9ef>a</span>:  <span style=color:#66d9ef>fa23</span>           <span style=color:#66d9ef>jne</span>   <span style=color:#75715e>#0x4490 &lt;enc+0xa&gt;
</span><span style=color:#75715e></span>
<span style=color:#75715e>; not sure what this is preparing for yet, but it looks
</span><span style=color:#75715e>; like r11 is being setup for a loop here.
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>449</span>c:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>c40</span> <span style=color:#ae81ff>7</span><span style=color:#66d9ef>c24</span>      <span style=color:#66d9ef>mov</span>   <span style=color:#75715e>#0x247c, r12
</span><span style=color:#75715e></span><span style=color:#ae81ff>44</span><span style=color:#66d9ef>a0</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>d43</span>           <span style=color:#66d9ef>clr</span>   <span style=color:#66d9ef>r13</span>
<span style=color:#960050;background-color:#1e0010>44</span>a2:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>b4d</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r13</span>, <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>44</span>a4:  <span style=color:#960050;background-color:#1e0010>684</span><span style=color:#a6e22e>c</span>           <span style=color:#66d9ef>mov.b</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#66d9ef>r12</span>, <span style=color:#66d9ef>r8</span>
<span style=color:#960050;background-color:#1e0010>44</span>a6:  <span style=color:#960050;background-color:#1e0010>4</span><span style=color:#a6e22e>a48</span>           <span style=color:#66d9ef>mov.b</span> <span style=color:#66d9ef>r8</span>, <span style=color:#66d9ef>r10</span>
<span style=color:#960050;background-color:#1e0010>44</span>a8:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>d5a</span>           <span style=color:#66d9ef>add</span>   <span style=color:#66d9ef>r10</span>, <span style=color:#66d9ef>r13</span>
<span style=color:#960050;background-color:#1e0010>44</span>aa:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>a4b</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r11</span>, <span style=color:#66d9ef>r10</span>

<span style=color:#75715e>; some arithmetic. maybe an indication of a decrypt of
</span><span style=color:#75715e>; some sorts or a simple byte swap happening here, needs
</span><span style=color:#75715e>; debugger
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>44</span>ac:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>af0</span> <span style=color:#ae81ff>0</span><span style=color:#66d9ef>f00</span>      <span style=color:#66d9ef>and</span>   <span style=color:#75715e>#0xf, r10
</span><span style=color:#75715e></span><span style=color:#ae81ff>44</span><span style=color:#66d9ef>b0</span>:  <span style=color:#ae81ff>5</span><span style=color:#66d9ef>a4a</span> <span style=color:#ae81ff>7244</span>      <span style=color:#66d9ef>mov.b</span> <span style=color:#ae81ff>0x4472</span>(<span style=color:#66d9ef>r10</span>), <span style=color:#66d9ef>r10</span>
<span style=color:#960050;background-color:#1e0010>44</span>b4:  <span style=color:#960050;background-color:#1e0010>8</span><span style=color:#a6e22e>a11</span>           <span style=color:#66d9ef>sxt</span>   <span style=color:#66d9ef>r10</span>
<span style=color:#960050;background-color:#1e0010>44</span>b6:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>d5a</span>           <span style=color:#66d9ef>add</span>   <span style=color:#66d9ef>r10</span>, <span style=color:#66d9ef>r13</span>
<span style=color:#960050;background-color:#1e0010>44</span>b8:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>df0</span> <span style=color:#66d9ef>ff00</span>      <span style=color:#66d9ef>and</span>   <span style=color:#75715e>#0xff, r13
</span><span style=color:#75715e></span><span style=color:#ae81ff>44</span><span style=color:#66d9ef>bc</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>a4d</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r13</span>, <span style=color:#66d9ef>r10</span>
<span style=color:#960050;background-color:#1e0010>44</span>be:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>a50</span> <span style=color:#ae81ff>7</span><span style=color:#66d9ef>c24</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0x247c, r10
</span><span style=color:#75715e></span><span style=color:#ae81ff>44</span><span style=color:#66d9ef>c2</span>:  <span style=color:#ae81ff>694</span><span style=color:#66d9ef>a</span>           <span style=color:#66d9ef>mov.b</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#66d9ef>r10</span>, <span style=color:#66d9ef>r9</span>
<span style=color:#960050;background-color:#1e0010>44</span>c4:  <span style=color:#a6e22e>ca48</span> <span style=color:#ae81ff>0000</span>      <span style=color:#66d9ef>mov.b</span> <span style=color:#66d9ef>r8</span>, <span style=color:#ae81ff>0x0</span>(<span style=color:#66d9ef>r10</span>)
<span style=color:#960050;background-color:#1e0010>44</span>c8:  <span style=color:#a6e22e>cc49</span> <span style=color:#ae81ff>0000</span>      <span style=color:#66d9ef>mov.b</span> <span style=color:#66d9ef>r9</span>, <span style=color:#ae81ff>0x0</span>(<span style=color:#66d9ef>r12</span>)
<span style=color:#960050;background-color:#1e0010>44</span>cc:  <span style=color:#960050;background-color:#1e0010>1</span><span style=color:#a6e22e>b53</span>           <span style=color:#66d9ef>inc</span>   <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>44</span>ce:  <span style=color:#960050;background-color:#1e0010>1</span><span style=color:#a6e22e>c53</span>           <span style=color:#66d9ef>inc</span>   <span style=color:#66d9ef>r12</span>

<span style=color:#75715e>; the loop with r11 for another 256 bytes
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>44</span>d0:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>b90</span> <span style=color:#ae81ff>0001</span>      <span style=color:#66d9ef>cmp</span>   <span style=color:#75715e>#0x100, r11
</span><span style=color:#75715e></span><span style=color:#ae81ff>44</span><span style=color:#66d9ef>d4</span>:  <span style=color:#66d9ef>e723</span>           <span style=color:#66d9ef>jne</span>   <span style=color:#75715e>#0x44a4 &lt;enc+0x1e&gt;
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>44</span>d6:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>b43</span>           <span style=color:#66d9ef>clr</span>   <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>44</span>d8:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>c4b</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r11</span>, <span style=color:#66d9ef>r12</span>
<span style=color:#960050;background-color:#1e0010>44</span>da:  <span style=color:#960050;background-color:#1e0010>183</span><span style=color:#a6e22e>c</span>           <span style=color:#66d9ef>jmp</span>   <span style=color:#75715e>#0x450c &lt;enc+0x86&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>44</span><span style=color:#66d9ef>dc</span>:  <span style=color:#ae81ff>1</span><span style=color:#66d9ef>c53</span>           <span style=color:#66d9ef>inc</span>   <span style=color:#66d9ef>r12</span>
<span style=color:#960050;background-color:#1e0010>44</span>de:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>cf0</span> <span style=color:#66d9ef>ff00</span>      <span style=color:#66d9ef>and</span>   <span style=color:#75715e>#0xff, r12
</span><span style=color:#75715e></span><span style=color:#ae81ff>44</span><span style=color:#66d9ef>e2</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>a4c</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r12</span>, <span style=color:#66d9ef>r10</span>
<span style=color:#960050;background-color:#1e0010>44</span>e4:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>a50</span> <span style=color:#ae81ff>7</span><span style=color:#66d9ef>c24</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0x247c, r10
</span><span style=color:#75715e></span><span style=color:#ae81ff>44</span><span style=color:#66d9ef>e8</span>:  <span style=color:#ae81ff>684</span><span style=color:#66d9ef>a</span>           <span style=color:#66d9ef>mov.b</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#66d9ef>r10</span>, <span style=color:#66d9ef>r8</span>
<span style=color:#960050;background-color:#1e0010>44</span>ea:  <span style=color:#960050;background-color:#1e0010>4</span><span style=color:#a6e22e>b58</span>           <span style=color:#66d9ef>add.b</span> <span style=color:#66d9ef>r8</span>, <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>44</span>ec:  <span style=color:#960050;background-color:#1e0010>4</span><span style=color:#a6e22e>b4b</span>           <span style=color:#66d9ef>mov.b</span> <span style=color:#66d9ef>r11</span>, <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>44</span>ee:  <span style=color:#960050;background-color:#1e0010>0</span><span style=color:#a6e22e>d4b</span>           <span style=color:#66d9ef>mov</span>   <span style=color:#66d9ef>r11</span>, <span style=color:#66d9ef>r13</span>
<span style=color:#960050;background-color:#1e0010>44</span>f0:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>d50</span> <span style=color:#ae81ff>7</span><span style=color:#66d9ef>c24</span>      <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#0x247c, r13
</span><span style=color:#75715e></span><span style=color:#ae81ff>44</span><span style=color:#66d9ef>f4</span>:  <span style=color:#ae81ff>694</span><span style=color:#66d9ef>d</span>           <span style=color:#66d9ef>mov.b</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#66d9ef>r13</span>, <span style=color:#66d9ef>r9</span>
<span style=color:#960050;background-color:#1e0010>44</span>f6:  <span style=color:#a6e22e>cd48</span> <span style=color:#ae81ff>0000</span>      <span style=color:#66d9ef>mov.b</span> <span style=color:#66d9ef>r8</span>, <span style=color:#ae81ff>0x0</span>(<span style=color:#66d9ef>r13</span>)
<span style=color:#960050;background-color:#1e0010>44</span>fa:  <span style=color:#a6e22e>ca49</span> <span style=color:#ae81ff>0000</span>      <span style=color:#66d9ef>mov.b</span> <span style=color:#66d9ef>r9</span>, <span style=color:#ae81ff>0x0</span>(<span style=color:#66d9ef>r10</span>)
<span style=color:#960050;background-color:#1e0010>44</span>fe:  <span style=color:#960050;background-color:#1e0010>695</span><span style=color:#a6e22e>d</span>           <span style=color:#66d9ef>add.b</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#66d9ef>r13</span>, <span style=color:#66d9ef>r9</span>
<span style=color:#960050;background-color:#1e0010>4500:</span>  <span style=color:#960050;background-color:#1e0010>4</span><span style=color:#a6e22e>d49</span>           <span style=color:#66d9ef>mov.b</span> <span style=color:#66d9ef>r9</span>, <span style=color:#66d9ef>r13</span>

<span style=color:#75715e>; probably the actual decryption taking place here, as
</span><span style=color:#75715e>; r15 (which was set in main) is used as an offset.
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>4502:</span>  <span style=color:#a6e22e>dfed</span> <span style=color:#ae81ff>7</span><span style=color:#66d9ef>c24</span> <span style=color:#ae81ff>0000</span> <span style=color:#66d9ef>xor.b</span> <span style=color:#ae81ff>0x247c</span>(<span style=color:#66d9ef>r13</span>), <span style=color:#ae81ff>0x0</span>(<span style=color:#66d9ef>r15</span>)
<span style=color:#960050;background-color:#1e0010>4508:</span>  <span style=color:#960050;background-color:#1e0010>1</span><span style=color:#a6e22e>f53</span>           <span style=color:#66d9ef>inc</span>   <span style=color:#66d9ef>r15</span>

<span style=color:#75715e>; decrement r14 until we get to 0, which will prevent the
</span><span style=color:#75715e>; jmp back up from being taken, ending the routine.
</span><span style=color:#75715e></span>
<span style=color:#75715e>; r14 was set to to 0xf8 (248) in main, so that might mean
</span><span style=color:#75715e>; that the decrypted bytes is 248 long.
</span><span style=color:#75715e></span>
<span style=color:#960050;background-color:#1e0010>450</span>a:  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>e53</span>           <span style=color:#66d9ef>add</span>   <span style=color:#75715e>#-0x1, r14
</span><span style=color:#75715e></span><span style=color:#ae81ff>450</span><span style=color:#66d9ef>c</span>:  <span style=color:#ae81ff>0</span><span style=color:#66d9ef>e93</span>           <span style=color:#66d9ef>tst</span>   <span style=color:#66d9ef>r14</span>
<span style=color:#960050;background-color:#1e0010>450</span>e:  <span style=color:#a6e22e>e623</span>           <span style=color:#66d9ef>jnz</span>   <span style=color:#75715e>#0x44dc &lt;enc+0x56&gt;
</span><span style=color:#75715e></span><span style=color:#ae81ff>4510</span>:  <span style=color:#ae81ff>3841</span>           <span style=color:#66d9ef>pop</span>   <span style=color:#66d9ef>r8</span>
<span style=color:#960050;background-color:#1e0010>4512:</span>  <span style=color:#960050;background-color:#1e0010>3941</span>           <span style=color:#a6e22e>pop</span>   <span style=color:#66d9ef>r9</span>
<span style=color:#960050;background-color:#1e0010>4514:</span>  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>a41</span>           <span style=color:#66d9ef>pop</span>   <span style=color:#66d9ef>r10</span>
<span style=color:#960050;background-color:#1e0010>4516:</span>  <span style=color:#960050;background-color:#1e0010>3</span><span style=color:#a6e22e>b41</span>           <span style=color:#66d9ef>pop</span>   <span style=color:#66d9ef>r11</span>
<span style=color:#960050;background-color:#1e0010>4518:</span>  <span style=color:#960050;background-color:#1e0010>3041</span>           <span style=color:#a6e22e>ret</span>
</code></pre></div><p>As you can see, this is a busy routine. There is very clearly some form of byte write, swapping and <code>xor</code> occurring as expected. Some key points to note though is that the memory location <code>0x2400</code> that was written to <code>r15</code> in main is used as a starting offset for an <code>xor</code> instruction occurring within <code>enc</code>. So, that is definitely an interesting location to watch as we debug this routine.</p>
<h3 id=debugging>debugging<a hidden class=anchor aria-hidden=true href=#debugging>#</a></h3>
<p>To gain a better understanding of what is happening in <code>enc</code>, I set a breakpoint at the entry point of this routine with <code>break 4486</code>. Then continuing the CPU and manually stepping through the instructions while watching what happens around memory address <code>0x2400</code> revealed the following:</p>
<figure>
<img loading=lazy src=/images/microcorruption/reykjavik_memory_start_decrypt.png>
</figure>
<p>It looks like a payload already lives from <code>0x2400</code> and a range of bytes from <code>0x00</code> to <code>0xff</code> is written from <code>0x247c</code> onwards.</p>
<figure>
<img loading=lazy src=/images/microcorruption/reykjavik_first_byte_writes.png>
</figure>
<p>This memory state is achieved right after this loop has completed and the jump at <code>0x449a</code> is not taken. Alright. Lets move on. The next loop also does a whole bunch of manipulations on the byte range that was just written to memory (and a few other things). There are some weird instructions like the <code>mov.b r11,r11</code> at <code>0x44ec</code> that I couldn&rsquo;t quite understand, but nonetheless.</p>
<p>The most important thing to see in this loop is that the bytes at <code>0x2400</code> are XOR&rsquo;d with those at <code>0x24f9</code> when the <code>xor.b 0x247c(r13), 0x0(r15)</code> instruction is called the first time. The second time, <code>0x247c(r13)</code> calculates to <code>0x24b6</code>, which is the next XOR.</p>
<figure>
<img loading=lazy src=/images/microcorruption/reykjavik_first_xor.png>
</figure>
<p>This loop continues until <code>r14</code> reaches zero, and the registers before the call to <code>enc</code> is restored and the function returns. At this stage, the memory contents at <code>0x2400</code> looks as follows (which should now be the decrypted contents):</p>
<figure>
<img loading=lazy src=/images/microcorruption/reykjavik_post_decryt.png>
</figure>
<p>At this stage its pretty clear that the call to jump to <code>0x2400</code> in <code>main</code> was because then the encrypted opcodes would be available there and further processing should take place. Now, reading the opcodes like that from a memory dump sucks. So, to make it a little more digestible, I slapped the dump into <a href=https://onlinedisassembler.com>https://onlinedisassembler.com</a>. The process was pretty simple; select the memory dump from microcorruption, paste it into a file, cleanup the dump with <code>cat dump | cut -d" " -f2-11</code> and paste that result into the RAW section in the disassembler. Finally, set the architecture to MSP430 and profit!</p>
<figure>
<img loading=lazy src=/images/microcorruption/reykjavik_decrypted_dissasembler.png>
</figure>
<p>After pasting that into the disassembler, I quickly realised that the whole payload might not be valid code for this section. After the <code>ret</code> the instructions became pretty crazy, so I just removed those. The final opcodes I used (which was ~256 bytes when counted with <code>cat dump.raw | tr -d ' ' | wc -c</code>) were:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>0b12 0412 0441 2452 3150 e0ff 3b40 2045
073c 1b53 8f11 0f12 0312 b012 6424 2152
6f4b 4f93 f623 3012 0a00 0312 b012 6424
2152 3012 1f00 3f40 dcff 0f54 0f12 2312
b012 6424 3150 0600 b490 db01 dcff 0520
3012 7f00 b012 6424 2153 3150 2000 3441
3b41 3041 1e41 0200 0212 0f4e 8f10 024f
32d0 0080 b012 1000 3241 3041
</code></pre></div><p>Anyways, I could now step through these instructions in the debugger, and have a disassembled reference I could refer to and see what is happening. The opcodes in the online disassembler would also correspond with those on microcorruption at the top right section which helped confirm that I was on the right track.</p>
<p>Stepping through each instruction, annotating what I thought was happening helped me understand what was going on. After a few rounds of running the routine, the following instructions were the most interesting as they were the instructions called just before it would jump away from the unlocking logic.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=color:#a6e22e>cmp</span> <span style=color:#75715e>#0x1db, -0x24(r4)
</span><span style=color:#75715e></span><span style=color:#66d9ef>jnz</span> <span style=color:#66d9ef>$</span><span style=color:#960050;background-color:#1e0010>+</span><span style=color:#ae81ff>0xc</span>
</code></pre></div><p>I needed to see what is happening at <code>-0x24(r4)</code> and see if I can control that value. To help me locate the memory location of the data used for the <code>cmp</code>, I had to do a little offset calculation. First, the <code>cmp</code> instruction was at <code>0x2448</code>, found by simply looking at the program counter (<code>pc</code>) as I debugged the routine. A breakpoint here let me inspect the registers and perform the offset calculations needed to know what data was used in the <code>cmp</code>. Register <code>r4</code> contained <code>0x43fe</code> which is 17406, so taking <code>0x24</code> (36) from that ends you up with <code>0x43fe</code>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#ae81ff>0x43fe</span>
<span style=color:#ae81ff>17406</span>
<span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#ae81ff>0x43fe</span><span style=color:#f92672>-</span><span style=color:#ae81ff>36</span>
<span style=color:#ae81ff>17370</span>
<span style=color:#f92672>&gt;&gt;&gt;</span> hex(<span style=color:#ae81ff>0x43fe</span><span style=color:#f92672>-</span><span style=color:#ae81ff>36</span>)
<span style=color:#e6db74>&#39;0x43da&#39;</span>
</code></pre></div><figure>
<img loading=lazy src=/images/microcorruption/reykjavik_password_buffer.png>
</figure>
<p>The data at <code>0x43da</code> was the start of my password buffer, which is effectively what is being used in the <code>cmp</code> instruction. Making sure my password entered started with <code>0xdb01</code> (remember, little endian) would be enough for this compare to result in the status flag being set to not have the next conditional jump taken, resulting in a value of <code>0x7f</code> being pushed to the stack and a syscall being made to unlock the lock!</p>
<p>My final, annotated version of the dissasembled opcodes looked as follows:</p>
<figure>
<img loading=lazy src=/images/microcorruption/reykjavik_annotated_decrypted_opcodes.png>
</figure>
<h2 id=solution>solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h2>
<p>Enter <code>db01</code> as hex encoded input.</p>
<h2 id=other-challenges>other challenges<a hidden class=anchor aria-hidden=true href=#other-challenges>#</a></h2>
<p>For my other write ups in the microcorruption series, checkout <a href=https://leonjza.github.io/categories/microcorruption/>this</a> link.</p>
</div>
<footer class=post-footer>
<nav class=paginav>
<a class=prev href=https://leonjza.github.io/blog/2018/03/07/microcorruption-whitehorse/>
<span class=title>« Prev Page</span>
<br>
<span>microcorruption - whitehorse</span>
</a>
<a class=next href=https://leonjza.github.io/blog/2018/03/06/microcorruption-cusco/>
<span class=title>Next Page »</span>
<br>
<span>microcorruption - cusco</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share microcorruption - reykjavik on twitter" href="https://twitter.com/intent/tweet/?text=microcorruption%20-%20reykjavik&url=https%3a%2f%2fleonjza.github.io%2fblog%2f2018%2f03%2f06%2fmicrocorruption-reykjavik%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share microcorruption - reykjavik on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fleonjza.github.io%2fblog%2f2018%2f03%2f06%2fmicrocorruption-reykjavik%2f&title=microcorruption%20-%20reykjavik&summary=microcorruption%20-%20reykjavik&source=https%3a%2f%2fleonjza.github.io%2fblog%2f2018%2f03%2f06%2fmicrocorruption-reykjavik%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share microcorruption - reykjavik on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fleonjza.github.io%2fblog%2f2018%2f03%2f06%2fmicrocorruption-reykjavik%2f&title=microcorruption%20-%20reykjavik"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share microcorruption - reykjavik on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fleonjza.github.io%2fblog%2f2018%2f03%2f06%2fmicrocorruption-reykjavik%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share microcorruption - reykjavik on whatsapp" href="https://api.whatsapp.com/send?text=microcorruption%20-%20reykjavik%20-%20https%3a%2f%2fleonjza.github.io%2fblog%2f2018%2f03%2f06%2fmicrocorruption-reykjavik%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share microcorruption - reykjavik on telegram" href="https://telegram.me/share/url?text=microcorruption%20-%20reykjavik&url=https%3a%2f%2fleonjza.github.io%2fblog%2f2018%2f03%2f06%2fmicrocorruption-reykjavik%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>@leonjza</span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>