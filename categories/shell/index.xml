<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Shell on #!/slash/note</title>
    <link>https://leonjza.github.io/categories/shell/</link>
    <description>Recent content in Shell on #!/slash/note</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 30 Sep 2015 19:39:55 +0000</lastBuildDate>
    <atom:link href="https://leonjza.github.io/categories/shell/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>a totally unnecessary composer shell</title>
      <link>https://leonjza.github.io/blog/2015/09/30/a-totally-unnecessary-composer-shell/</link>
      <pubDate>Wed, 30 Sep 2015 19:39:55 +0000</pubDate>
      
      <guid>https://leonjza.github.io/blog/2015/09/30/a-totally-unnecessary-composer-shell/</guid>
      <description>

&lt;h2 id=&#34;background:81933f3676c079333a579b7c058765d8&#34;&gt;background&lt;/h2&gt;

&lt;p&gt;{% img right &lt;a href=&#34;https://i.imgur.com/9kOuWWP.png&#34;&gt;https://i.imgur.com/9kOuWWP.png&lt;/a&gt; %}&lt;/p&gt;

&lt;p&gt;A silly reverse shell invoked via the Composer Dependency Manager. &lt;a href=&#34;https://github.com/leonjza/composer-shell&#34;&gt;Source here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://getcomposer.org/&#34;&gt;Composer&lt;/a&gt;, which is most probably &lt;em&gt;the&lt;/em&gt; most popular PHP dependency manager allows for &lt;a href=&#34;https://getcomposer.org/doc/articles/scripts.md&#34;&gt;scripts&lt;/a&gt; to run as callbacks on based an event.
Callbacks are normally triggered just before or after certain events.&lt;/p&gt;

&lt;p&gt;It is possible to provide shell commands to the &lt;code&gt;scripts&lt;/code&gt; property in the required &lt;code&gt;composer.json&lt;/code&gt; file (with a few restrictions), but this method echoes the command that it executes.
A slightly more covert approach would be to execute a cleverly named static function in a class included in the codebase. It has to be one that can be autoloaded by composer.&lt;/p&gt;

&lt;h2 id=&#34;why:81933f3676c079333a579b7c058765d8&#34;&gt;why?&lt;/h2&gt;

&lt;p&gt;I thought a little about which scenarios this may actually be useful in and figured maybe only really strange edge cases where you can only run composer (as root lol?).
I also remembered a bug in &lt;a href=&#34;https://community.rapid7.com/community/metasploit/blog/2015/01/01/12-days-of-haxmas-exploiting-cve-2014-9390-in-git-and-mercurial&#34;&gt;git&lt;/a&gt; (CVE-2014-9390) that allowed for code execution via &amp;lsquo;poisoned&amp;rsquo; repositories. Well, I guess depending on your perspective, this may be a very similar.&lt;/p&gt;

&lt;h2 id=&#34;poc:81933f3676c079333a579b7c058765d8&#34;&gt;PoC&lt;/h2&gt;

&lt;p&gt;As part of a PoC, I just used the popular &lt;a href=&#34;http://pentestmonkey.net/tools/web-shells/php-reverse-shell&#34;&gt;pentest-monkey PHP reverse shell&lt;/a&gt;, but really, anything is possible that is possible with PHP at this point.&lt;/p&gt;

&lt;script type=&#34;text/javascript&#34; src=&#34;https://asciinema.org/a/b64qlhadvl7zn1912ihwi09wt.js&#34; id=&#34;asciicast-b64qlhadvl7zn1912ihwi09wt&#34; data-size=&#34;medium&#34; async&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>Quick Win: Quickly Execute Last Shell Command</title>
      <link>https://leonjza.github.io/2013/06/23/quick-win-quickly-execute-last-shell-command/</link>
      <pubDate>Sun, 23 Jun 2013 00:00:00 +0000</pubDate>
      
      <guid>https://leonjza.github.io/2013/06/23/quick-win-quickly-execute-last-shell-command/</guid>
      <description>

&lt;h3 id=&#34;work-clever-not-hard:191b7b3d1ffb3e6f6d2e0558cbd749f9&#34;&gt;Work clever, not hard&lt;/h3&gt;

&lt;p&gt;This will be the first post of a series of quick shell tips for getting things done, fast. Infact, it will probably just serve as a notepad for me on the topic ;)&lt;/p&gt;

&lt;h3 id=&#34;last-shell-command:191b7b3d1ffb3e6f6d2e0558cbd749f9&#34;&gt;Last shell command&lt;/h3&gt;

&lt;p&gt;If you are using a shell, such as &lt;a href=&#34;http://www.gnu.org/software/bash/bash.html&#34;&gt;Bash&lt;/a&gt;, which is pretty much the default on most Linux distributions, then you probably know that you can just use the &lt;strong&gt;up&lt;/strong&gt; arrow to get the last command. But, if you are using a shell such as &lt;a href=&#34;http://www.zsh.org/&#34;&gt;Zsh&lt;/a&gt; like me, you&amp;rsquo;d quickly come to realise that the global &lt;code&gt;~/.histfile&lt;/code&gt; can be a tad frustrating if you are expecting the last command you typed in &lt;strong&gt;that&lt;/strong&gt; terminal window to appear when you press &lt;strong&gt;up&lt;/strong&gt;. Only to realise, its literally the last command you typed in &lt;em&gt;another&lt;/em&gt; shell.&lt;/p&gt;

&lt;h3 id=&#34;bang-bang-to-the-rescue:191b7b3d1ffb3e6f6d2e0558cbd749f9&#34;&gt;Bang Bang to the rescue!&lt;/h3&gt;

&lt;p&gt;Simply type &lt;code&gt;!!&lt;/code&gt; and &lt;em&gt;enter&lt;/em&gt; and the last command that was run in &lt;strong&gt;that&lt;/strong&gt; terminal will be either echoed or executed, depending on how your shell is configured to handle the command.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>