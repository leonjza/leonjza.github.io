<!doctype html><html lang=en>
<head>
<title>
writeup ::
#!/bin/note
— a checkbox uncheckers notepad
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=keywords content="blog,hack,ctf,leonjza,pentester,red team,attack">
<meta name=robots content="noodp">
<link rel=canonical href=https://leonjza.github.io/categories/writeup/>
<link rel=stylesheet href=https://leonjza.github.io/assets/style.css>
<link rel=stylesheet href=https://leonjza.github.io/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://leonjza.github.io/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://leonjza.github.io/img/favicon.png>
<link href=https://leonjza.github.io/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://leonjza.github.io/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="writeup">
<meta name=twitter:description content>
<meta property="og:title" content="writeup">
<meta property="og:description" content>
<meta property="og:type" content="website">
<meta property="og:url" content="https://leonjza.github.io/categories/writeup/"><meta property="og:site_name" content="#!/bin/note
">
<link rel=alternate type=application/rss+xml href=/categories/writeup/index.xml title="#!/bin/note
">
</head>
<body class=dark-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>#!/bin/note
</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about/>About Me</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about/>About Me</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=posts>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/05/09/dawgctf-2021/>DawgCTF 2021</a></h1>
<div class=post-meta>
<span class=post-date>
2021-05-09
</span>
<span class=post-read-time>— 5 min read</span>
</div>
<div class=post-content>
foreword DawgCTF 20201 was the first CTF I played together with some local people much smarter than me over at Hack South. We managed to grab 28th place too.
I only solved three challenges with the time I had in the morning (of which one was a dupe because reading is hard :P).
solutions reversing - calculator Category: Reversing Points: 50 Files: Windows PE This was the duplicate challenge, but I&rsquo;m writing up how I did it anyways.
</div>
<div>
<a class="read-more button" href=/blog/2021/05/09/dawgctf-2021/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/04/24/hack-the-box-cyber-apocalypse-ctf-21/>hack the box - cyber apocalypse ctf &lsquo;21</a></h1>
<div class=post-meta>
<span class=post-date>
2021-04-24
</span>
<span class=post-read-time>— 19 min read</span>
</div>
<div class=post-content>
foreword The HTB Cyber Apocalypse 2021 event was a nice and polished CTF. Apart from the usual start time load issues, everything ran pretty smoothly with nearly zero issues my side. Kudo&rsquo;s HTB! Here are the solutions for the ~20 challenges I managed to solve.
solutions category - web - BlitzProp Category: Web Difficulty: 1/4 Files: Web app source & build env The challenge landing page already had a hint in the &ldquo;ASTa la vista baby&rdquo; song.
</div>
<div>
<a class="read-more button" href=/blog/2021/04/24/hack-the-box-cyber-apocalypse-ctf-21/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-iot-itchy-scratchy-secureiot-co/>NahamCon2021 CTF - IoT Itchy & Scratchy SecureIoT Co</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 1 min read</span>
</div>
<div class=post-content>
category iot - hard
solution unfortunately the infra was down by the time I got to the writeup
We&rsquo;re given an IP and credentials, along with a reference to mosquito. There was also a URL that accepted a username, a password and OTP.
I used MQTT Explorer to connect to the mosquito server. With a bit of patience, an office topic received a message with a &ldquo;u&rdquo; and &ldquo;p&rdquo; flag, base64 encoded.
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-iot-itchy-scratchy-secureiot-co/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-microscopium/>NahamCon2021 CTF - Microscopium</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 2 min read</span>
</div>
<div class=post-content>
category mobile - medium
solution This was a fun one. We get an .apk to download. Open it in jadx and quickly see this is a React App.
package com.microscopium; import com.facebook.react.ReactActivity; public class MainActivity extends ReactActivity { /* access modifiers changed from: protected */ @Override // com.facebook.react.ReactActivity public String getMainComponentName() { return "Microscopium"; } } Being React, I expected a large chunk of the logic to be in a JavaScript file, which could be found in the resources section.
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-microscopium/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-resourceful/>NahamCon2021 CTF - Resourceful</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 1 min read</span>
</div>
<div class=post-content>
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-resourceful/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-andra/>NahamCon2021 CTF - Andra</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 1 min read</span>
</div>
<div class=post-content>
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-andra/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-ret2basic/>NahamCon2021 CTF - Ret2basic</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 2 min read</span>
</div>
<div class=post-content>
category binary exploitation - easy
solution The file we download is a ELF executable.
$ file ret2basic ret2basic: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=3ca85eae693fed659275c0eed9c313e7f0083b85, for GNU/Linux 4.4.0, not stripped Running it hints the vuln.
$ ./ret2basic Can you overflow this?: AAAA Nope :( $ $ ./ret2basic Can you overflow this?: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA [1] 9615 segmentation fault ./ret2basic $ Disassembling the binary, we find that main() eventually calls vuln where the overflow exists.
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-ret2basic/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-asserted/>NahamCon2021 CTF - Asserted</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 2 min read</span>
</div>
<div class=post-content>
category web - medium
solution The challenge URL dropped us on a page related to fitness, with not a lot of interesting interactions.
Navigating the pages you&rsquo;d see a URL scheme where a page parameter is set. Eg: page=about. An about.php also exists, so this was potentially vuln to LFI. Using .. in the page parameter resulted in a warning message indicating that some filtering was taking place.
$ curl "http://challenge.
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-asserted/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-agenttester/>NahamCon2021 CTF - AgentTester</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 2 min read</span>
</div>
<div class=post-content>
category web - medium
solution We&rsquo;re given an archive to download, agenttester.zip. This contained a Dockerfile and a python web application. The files in the archive had many secrets redacted which were set using environment variables. One specifically interesting one was CHALLENGE_FLAG, which we could assume was the target value to leak.
The challenge URL dropped us on a page where we need to login. So, create an account, login and land on the home page of the agent tester.
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-agenttester/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-bad-blog/>NahamCon2021 CTF - Bad Blog</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 1 min read</span>
</div>
<div class=post-content>
category web - medium
solution The challenge URL drops us on a page where we need to login. So, create an account, login and land on the home page of a blog.
After creating a new post, you can see who visited your blog in the profile section.
Poking around will reveal that if you tamper with your user agent string, that is what will show up in the analytics section.
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-bad-blog/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-cereal-and-milk/>NahamCon2021 CTF - Cereal and Milk</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 2 min read</span>
</div>
<div class=post-content>
category web - medium
solution The challenge URL drops us on a page where we can submit cereals.
We are also given two files to download, index.php & log.php. I quickly spotted an unsafe deserialisation bug in the provided files. The cleaned up and relevant PHP code from both files were:
index.php
&lt;?php include 'log.php'; class CerealAndMilk { public $logs = "request-logs.txt"; public $request = ''; public $cereal = 'Captain Crunch'; public $milk = ''; public function processed_data($output) { echo "Deserilized data:&lt;br> Coming soon.
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-cereal-and-milk/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-imposter/>NahamCon2021 CTF - Imposter</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 2 min read</span>
</div>
<div class=post-content>
category web - medium
solution This was a tricker, but fun one. The challenge URL drops us on a login page with an OTP field.
Signing up for an account responsed with a JSON structure containing a url key with an otpauth URI.
Request
POST /signup HTTP/1.1 Host: challenge.nahamcon.com:30809 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0 Accept: application/json Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://challenge.nahamcon.com:30809/signup Content-Type: application/json Origin: http://challenge.
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-imposter/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-echo/>NahamCon2021 CTF - Echo</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 1 min read</span>
</div>
<div class=post-content>
category warmups - easy
solution The challenge URL had a web based echo service.
Many special characters, except for &lt; and ` were filtered. It took me a while but I found the param had command injection. For example:
GET /?echo=`id` HTTP/1.1 Host: challenge.nahamcon.com:30074 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: close Referer: http://challenge.nahamcon.com:30074/?echo=food Cookie: auth2=eyJpZCI6MX0.YEp7Wg.fHdsxIGEolHgYQD0d_cvExass8E; auth=eyJpZCI6MX0.YEp7Wg.fHdsxIGEolHgYQD0d_cvExass8E Upgrade-Insecure-Requests: 1 Would respond with:
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-echo/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-homeward-bound/>NahamCon2021 CTF - Homeward Bound</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 1 min read</span>
</div>
<div class=post-content>
category web - easy
solution The challenge URL returns the message Sorry, this page is not accessible externally.
Add the X-Forwarded-For: 127.0.0.1 header to reveal the flag.
GET / HTTP/1.1 Host: challenge.nahamcon.com:30903 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: close X-Forwarded-For: 127.0.0.1 Cookie: auth2=eyJpZCI6MX0.YEp7Wg.fHdsxIGEolHgYQD0d_cvExass8E; auth=eyJpZCI6MX0.YEp7Wg.fHdsxIGEolHgYQD0d_cvExass8E Upgrade-Insecure-Requests: 1 The response has the flag.
&lt;p class="card-text"> &lt;div class="alert alert-success" role="alert"> &lt;b>Welcome!
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-homeward-bound/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-esab64/>NahamCon2021 CTF - Esab64</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 1 min read</span>
</div>
<div class=post-content>
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-esab64/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2021/03/15/nahamcon2021-ctf-pollex/>NahamCon2021 CTF - Pollex</a></h1>
<div class=post-meta>
<span class=post-date>
2021-03-15
</span>
<span class=post-read-time>— 2 min read</span>
</div>
<div class=post-content>
category warmups - easy
solution The downloaded file you get is an image, when opened looks like this:
Output of exiftool shows that there is a thumbnail, with a hint to extract it right at the bottom.
❯ exiftool pollex.jpg ExifTool Version Number : 12.16 File Name : pollex.jpg Directory : . File Size : 37 KiB File Modification Date/Time : 2021:03:13 13:40:45+02:00 File Access Date/Time : 2021:03:15 09:53:11+02:00 File Inode Change Date/Time : 2021:03:15 09:53:11+02:00 File Permissions : rw-r--r-- File Type : JPEG File Type Extension : jpg MIME Type : image/jpeg JFIF Version : 1.
</div>
<div>
<a class="read-more button" href=/blog/2021/03/15/nahamcon2021-ctf-pollex/>Read more →</a>
</div>
</div>
<div class="post on-list">
<h1 class=post-title><a href=https://leonjza.github.io/blog/2020/12/30/the-2020-kinglecon-3-holiday-hack-challenge/>the 2020 kinglecon 3 holiday hack challenge</a></h1>
<div class=post-meta>
<span class=post-date>
2020-12-30
</span>
<span class=post-read-time>— 69 min read</span>
</div>
<div class=post-content>
foreword After tweaking the final bits for a successful MD5 hash collision in a tampered blockchain block, I&rsquo;m met with a &ldquo;Congratulations&rdquo; message as I had just completed the final objective for the 2020 SANS Holiday Hack Challenge!
For a few days during my holiday break I set out to play the challenge this year. I&rsquo;ve dabbled with Holiday Hack challenges in the past, however, this was the first one I actually finished (thanks COVID?
</div>
<div>
<a class="read-more button" href=/blog/2020/12/30/the-2020-kinglecon-3-holiday-hack-challenge/>Read more →</a>
</div>
</div>
<div class=pagination>
<div class=pagination__buttons>
<span class="button next">
<a href=/categories/writeup/page/2/>
<span class=button__text>Older posts</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user"><a href=https://twitter.com/leonjza>@leonjza</a></div>
</div>
</footer>
<script src=https://leonjza.github.io/assets/main.js></script>
<script src=https://leonjza.github.io/assets/prism.js></script>
</div>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-44457032-2','auto'),ga('send','pageview'))</script>
</body>
</html>